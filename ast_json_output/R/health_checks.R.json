[
  {
    "type": "call",
    "fun": "library",
    "args": [
      {
        "type": "name",
        "value": "httr"
      }
    ]
  },
  {
    "type": "call",
    "fun": "library",
    "args": [
      {
        "type": "name",
        "value": "DBI"
      }
    ]
  },
  {
    "type": "call",
    "fun": "library",
    "args": [
      {
        "type": "name",
        "value": "jsonlite"
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": ".health_config"
      },
      {
        "type": "call",
        "fun": "new.env",
        "args": {
          "parent": {
            "type": "call",
            "fun": "emptyenv",
            "args": []
          }
        }
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "call",
        "fun": "$",
        "args": [
          {
            "type": "name",
            "value": ".health_config"
          },
          {
            "type": "name",
            "value": "checks_enabled"
          }
        ]
      },
      {
        "type": "literal",
        "value": true
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "call",
        "fun": "$",
        "args": [
          {
            "type": "name",
            "value": ".health_config"
          },
          {
            "type": "name",
            "value": "check_interval_seconds"
          }
        ]
      },
      {
        "type": "literal",
        "value": 60
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "call",
        "fun": "$",
        "args": [
          {
            "type": "name",
            "value": ".health_config"
          },
          {
            "type": "name",
            "value": "timeout_seconds"
          }
        ]
      },
      {
        "type": "literal",
        "value": 5
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "call",
        "fun": "$",
        "args": [
          {
            "type": "name",
            "value": ".health_config"
          },
          {
            "type": "name",
            "value": "memory_threshold_mb"
          }
        ]
      },
      {
        "type": "literal",
        "value": 500
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "call",
        "fun": "$",
        "args": [
          {
            "type": "name",
            "value": ".health_config"
          },
          {
            "type": "name",
            "value": "disk_threshold_percent"
          }
        ]
      },
      {
        "type": "literal",
        "value": 90
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "call",
        "fun": "$",
        "args": [
          {
            "type": "name",
            "value": ".health_config"
          },
          {
            "type": "name",
            "value": "cache_hit_threshold"
          }
        ]
      },
      {
        "type": "literal",
        "value": 0.5
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": ".health_status"
      },
      {
        "type": "call",
        "fun": "new.env",
        "args": {
          "parent": {
            "type": "call",
            "fun": "emptyenv",
            "args": []
          }
        }
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "call",
        "fun": "$",
        "args": [
          {
            "type": "name",
            "value": ".health_status"
          },
          {
            "type": "name",
            "value": "current"
          }
        ]
      },
      {
        "type": "call",
        "fun": "list",
        "args": []
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "call",
        "fun": "$",
        "args": [
          {
            "type": "name",
            "value": ".health_status"
          },
          {
            "type": "name",
            "value": "history"
          }
        ]
      },
      {
        "type": "call",
        "fun": "list",
        "args": []
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "call",
        "fun": "$",
        "args": [
          {
            "type": "name",
            "value": ".health_status"
          },
          {
            "type": "name",
            "value": "last_check"
          }
        ]
      },
      {
        "type": "NULL",
        "value": []
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "run_health_checks"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": "FALSE"
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "name",
                    "value": "verbose"
                  },
                  {
                    "type": "call",
                    "fun": "message",
                    "args": [
                      {
                        "type": "literal",
                        "value": "Starting system health checks..."
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "start_time"
                  },
                  {
                    "type": "call",
                    "fun": "Sys.time",
                    "args": []
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "results"
                  },
                  {
                    "type": "call",
                    "fun": "list",
                    "args": {
                      "timestamp": {
                        "type": "name",
                        "value": "start_time"
                      },
                      "overall_status": {
                        "type": "literal",
                        "value": "healthy"
                      },
                      "checks": {
                        "type": "call",
                        "fun": "list",
                        "args": []
                      }
                    }
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "results"
                          },
                          {
                            "type": "name",
                            "value": "checks"
                          }
                        ]
                      },
                      {
                        "type": "name",
                        "value": "database"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "check_database_health",
                    "args": []
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "results"
                          },
                          {
                            "type": "name",
                            "value": "checks"
                          }
                        ]
                      },
                      {
                        "type": "name",
                        "value": "fhir"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "check_fhir_health",
                    "args": []
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "results"
                          },
                          {
                            "type": "name",
                            "value": "checks"
                          }
                        ]
                      },
                      {
                        "type": "name",
                        "value": "filesystem"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "check_filesystem_health",
                    "args": []
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "results"
                          },
                          {
                            "type": "name",
                            "value": "checks"
                          }
                        ]
                      },
                      {
                        "type": "name",
                        "value": "memory"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "check_memory_health",
                    "args": []
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "results"
                          },
                          {
                            "type": "name",
                            "value": "checks"
                          }
                        ]
                      },
                      {
                        "type": "name",
                        "value": "api"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "check_api_health",
                    "args": []
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "results"
                          },
                          {
                            "type": "name",
                            "value": "checks"
                          }
                        ]
                      },
                      {
                        "type": "name",
                        "value": "auth"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "check_auth_health",
                    "args": []
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "results"
                          },
                          {
                            "type": "name",
                            "value": "checks"
                          }
                        ]
                      },
                      {
                        "type": "name",
                        "value": "cache"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "check_cache_health",
                    "args": []
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "results"
                          },
                          {
                            "type": "name",
                            "value": "checks"
                          }
                        ]
                      },
                      {
                        "type": "name",
                        "value": "audit"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "check_audit_health",
                    "args": []
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "results"
                          },
                          {
                            "type": "name",
                            "value": "checks"
                          }
                        ]
                      },
                      {
                        "type": "name",
                        "value": "models"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "check_model_health",
                    "args": []
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "statuses"
                  },
                  {
                    "type": "call",
                    "fun": "sapply",
                    "args": [
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "results"
                          },
                          {
                            "type": "name",
                            "value": "checks"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "function",
                        "args": [
                          {
                            "type": "pairlist",
                            "value": ""
                          },
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "x"
                              },
                              {
                                "type": "name",
                                "value": "status"
                              }
                            ]
                          },
                          {
                            "type": "NULL",
                            "value": []
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "any",
                    "args": [
                      {
                        "type": "call",
                        "fun": "==",
                        "args": [
                          {
                            "type": "name",
                            "value": "statuses"
                          },
                          {
                            "type": "literal",
                            "value": "critical"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "results"
                              },
                              {
                                "type": "name",
                                "value": "overall_status"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "critical"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "if",
                    "args": [
                      {
                        "type": "call",
                        "fun": "any",
                        "args": [
                          {
                            "type": "call",
                            "fun": "==",
                            "args": [
                              {
                                "type": "name",
                                "value": "statuses"
                              },
                              {
                                "type": "literal",
                                "value": "degraded"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "{",
                        "args": [
                          {
                            "type": "call",
                            "fun": "<-",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "results"
                                  },
                                  {
                                    "type": "name",
                                    "value": "overall_status"
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": "degraded"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "any",
                            "args": [
                              {
                                "type": "call",
                                "fun": "==",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "statuses"
                                  },
                                  {
                                    "type": "literal",
                                    "value": "warning"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "results"
                                      },
                                      {
                                        "type": "name",
                                        "value": "overall_status"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "literal",
                                    "value": "warning"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "results"
                                      },
                                      {
                                        "type": "name",
                                        "value": "overall_status"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "literal",
                                    "value": "healthy"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": "results"
                      },
                      {
                        "type": "name",
                        "value": "duration_ms"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "*",
                    "args": [
                      {
                        "type": "call",
                        "fun": "as.numeric",
                        "args": [
                          {
                            "type": "call",
                            "fun": "difftime",
                            "args": {
                              "1": {
                                "type": "call",
                                "fun": "Sys.time",
                                "args": []
                              },
                              "2": {
                                "type": "name",
                                "value": "start_time"
                              },
                              "units": {
                                "type": "literal",
                                "value": "secs"
                              }
                            }
                          }
                        ]
                      },
                      {
                        "type": "literal",
                        "value": 1000
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": ".health_status"
                      },
                      {
                        "type": "name",
                        "value": "current"
                      }
                    ]
                  },
                  {
                    "type": "name",
                    "value": "results"
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": ".health_status"
                      },
                      {
                        "type": "name",
                        "value": "last_check"
                      }
                    ]
                  },
                  {
                    "type": "name",
                    "value": "start_time"
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": ".health_status"
                      },
                      {
                        "type": "name",
                        "value": "history"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "c",
                    "args": [
                      {
                        "type": "call",
                        "fun": "list",
                        "args": [
                          {
                            "type": "name",
                            "value": "results"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": ".health_status"
                          },
                          {
                            "type": "name",
                            "value": "history"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": ">",
                    "args": [
                      {
                        "type": "call",
                        "fun": "length",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": ".health_status"
                              },
                              {
                                "type": "name",
                                "value": "history"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "literal",
                        "value": 100
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": ".health_status"
                              },
                              {
                                "type": "name",
                                "value": "history"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "[",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": ".health_status"
                                  },
                                  {
                                    "type": "name",
                                    "value": "history"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": ":",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": 1
                                  },
                                  {
                                    "type": "literal",
                                    "value": 100
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "name",
                    "value": "verbose"
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "print_health_summary",
                        "args": [
                          {
                            "type": "name",
                            "value": "results"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "==",
                    "args": [
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "results"
                          },
                          {
                            "type": "name",
                            "value": "overall_status"
                          }
                        ]
                      },
                      {
                        "type": "literal",
                        "value": "critical"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "log_critical_health_issues",
                        "args": [
                          {
                            "type": "name",
                            "value": "results"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "return",
                "args": [
                  {
                    "type": "name",
                    "value": "results"
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "check_database_health"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "NULL",
            "value": []
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "result"
                  },
                  {
                    "type": "call",
                    "fun": "list",
                    "args": {
                      "component": {
                        "type": "literal",
                        "value": "database"
                      },
                      "status": {
                        "type": "literal",
                        "value": "unknown"
                      },
                      "message": {
                        "type": "literal",
                        "value": ""
                      },
                      "metrics": {
                        "type": "call",
                        "fun": "list",
                        "args": []
                      },
                      "checked_at": {
                        "type": "call",
                        "fun": "Sys.time",
                        "args": []
                      }
                    }
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "db_config"
                  },
                  {
                    "type": "call",
                    "fun": "tryCatch",
                    "args": {
                      "1": {
                        "type": "call",
                        "fun": "{",
                        "args": [
                          {
                            "type": "call",
                            "fun": "source",
                            "args": {
                              "1": {
                                "type": "literal",
                                "value": "R/db.R"
                              },
                              "local": {
                                "type": "literal",
                                "value": true
                              }
                            }
                          },
                          {
                            "type": "call",
                            "fun": "get_db_config",
                            "args": []
                          }
                        ]
                      },
                      "error": {
                        "type": "call",
                        "fun": "function",
                        "args": [
                          {
                            "type": "pairlist",
                            "value": ""
                          },
                          {
                            "type": "NULL",
                            "value": []
                          },
                          {
                            "type": "NULL",
                            "value": []
                          }
                        ]
                      }
                    }
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "is.null",
                    "args": [
                      {
                        "type": "name",
                        "value": "db_config"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "status"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "warning"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "message"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "Database not configured"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "return",
                        "args": [
                          {
                            "type": "name",
                            "value": "result"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "tryCatch",
                "args": {
                  "1": {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "conn"
                          },
                          {
                            "type": "call",
                            "fun": ["::", "DBI", "dbConnect"],
                            "args": {
                              "1": {
                                "type": "call",
                                "fun": ["::", "RPostgres", "Postgres"],
                                "args": []
                              },
                              "host": {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "db_config"
                                  },
                                  {
                                    "type": "name",
                                    "value": "host"
                                  }
                                ]
                              },
                              "port": {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "db_config"
                                  },
                                  {
                                    "type": "name",
                                    "value": "port"
                                  }
                                ]
                              },
                              "dbname": {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "db_config"
                                  },
                                  {
                                    "type": "name",
                                    "value": "database"
                                  }
                                ]
                              },
                              "user": {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "db_config"
                                  },
                                  {
                                    "type": "name",
                                    "value": "user"
                                  }
                                ]
                              },
                              "password": {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "db_config"
                                  },
                                  {
                                    "type": "name",
                                    "value": "password"
                                  }
                                ]
                              }
                            }
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "test_start"
                          },
                          {
                            "type": "call",
                            "fun": "Sys.time",
                            "args": []
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "test_result"
                          },
                          {
                            "type": "call",
                            "fun": ["::", "DBI", "dbGetQuery"],
                            "args": [
                              {
                                "type": "name",
                                "value": "conn"
                              },
                              {
                                "type": "literal",
                                "value": "SELECT 1 as test"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "query_time"
                          },
                          {
                            "type": "call",
                            "fun": "*",
                            "args": [
                              {
                                "type": "call",
                                "fun": "as.numeric",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "difftime",
                                    "args": {
                                      "1": {
                                        "type": "call",
                                        "fun": "Sys.time",
                                        "args": []
                                      },
                                      "2": {
                                        "type": "name",
                                        "value": "test_start"
                                      },
                                      "units": {
                                        "type": "literal",
                                        "value": "secs"
                                      }
                                    }
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": 1000
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "pool_info"
                          },
                          {
                            "type": "call",
                            "fun": ["::", "DBI", "dbGetInfo"],
                            "args": [
                              {
                                "type": "name",
                                "value": "conn"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "table_sizes"
                          },
                          {
                            "type": "call",
                            "fun": ["::", "DBI", "dbGetQuery"],
                            "args": [
                              {
                                "type": "name",
                                "value": "conn"
                              },
                              {
                                "type": "literal",
                                "value": "\n      SELECT \n        schemaname,\n        tablename,\n        pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) AS size\n      FROM pg_tables \n      WHERE schemaname = 'public'\n      ORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC\n      LIMIT 5\n    "
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": ["::", "DBI", "dbDisconnect"],
                        "args": [
                          {
                            "type": "name",
                            "value": "conn"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "status"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "if",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "query_time"
                                  },
                                  {
                                    "type": "literal",
                                    "value": 100
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": "healthy"
                              },
                              {
                                "type": "call",
                                "fun": "if",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "<",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "query_time"
                                      },
                                      {
                                        "type": "literal",
                                        "value": 500
                                      }
                                    ]
                                  },
                                  {
                                    "type": "literal",
                                    "value": "warning"
                                  },
                                  {
                                    "type": "literal",
                                    "value": "degraded"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "message"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "sprintf",
                            "args": [
                              {
                                "type": "literal",
                                "value": "Database responsive (query time: %.0fms)"
                              },
                              {
                                "type": "name",
                                "value": "query_time"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "metrics"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "list",
                            "args": {
                              "query_time_ms": {
                                "type": "name",
                                "value": "query_time"
                              },
                              "connection_count": {
                                "type": "call",
                                "fun": "%||%",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "pool_info"
                                      },
                                      {
                                        "type": "name",
                                        "value": "connections"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "literal",
                                    "value": null
                                  }
                                ]
                              },
                              "largest_tables": {
                                "type": "name",
                                "value": "table_sizes"
                              }
                            }
                          }
                        ]
                      }
                    ]
                  },
                  "error": {
                    "type": "call",
                    "fun": "function",
                    "args": [
                      {
                        "type": "pairlist",
                        "value": ""
                      },
                      {
                        "type": "call",
                        "fun": "{",
                        "args": [
                          {
                            "type": "call",
                            "fun": "<-",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "name",
                                    "value": "status"
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": "critical"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "<-",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "name",
                                    "value": "message"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "sprintf",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": "Database connection failed: %s"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "e"
                                      },
                                      {
                                        "type": "name",
                                        "value": "message"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "NULL",
                        "value": []
                      }
                    ]
                  }
                }
              },
              {
                "type": "call",
                "fun": "return",
                "args": [
                  {
                    "type": "name",
                    "value": "result"
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "check_fhir_health"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "NULL",
            "value": []
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "result"
                  },
                  {
                    "type": "call",
                    "fun": "list",
                    "args": {
                      "component": {
                        "type": "literal",
                        "value": "fhir"
                      },
                      "status": {
                        "type": "literal",
                        "value": "unknown"
                      },
                      "message": {
                        "type": "literal",
                        "value": ""
                      },
                      "metrics": {
                        "type": "call",
                        "fun": "list",
                        "args": []
                      },
                      "checked_at": {
                        "type": "call",
                        "fun": "Sys.time",
                        "args": []
                      }
                    }
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "fhir_url"
                  },
                  {
                    "type": "call",
                    "fun": "Sys.getenv",
                    "args": [
                      {
                        "type": "literal",
                        "value": "FHIR_BASE_URL"
                      },
                      {
                        "type": "literal",
                        "value": ""
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "==",
                    "args": [
                      {
                        "type": "call",
                        "fun": "nchar",
                        "args": [
                          {
                            "type": "name",
                            "value": "fhir_url"
                          }
                        ]
                      },
                      {
                        "type": "literal",
                        "value": 0
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "status"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "warning"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "message"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "FHIR server not configured"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "return",
                        "args": [
                          {
                            "type": "name",
                            "value": "result"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "tryCatch",
                "args": {
                  "1": {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "start_time"
                          },
                          {
                            "type": "call",
                            "fun": "Sys.time",
                            "args": []
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "response"
                          },
                          {
                            "type": "call",
                            "fun": ["::", "httr", "GET"],
                            "args": [
                              {
                                "type": "call",
                                "fun": "paste0",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "fhir_url"
                                  },
                                  {
                                    "type": "literal",
                                    "value": "/metadata"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": ["::", "httr", "timeout"],
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": ".health_config"
                                      },
                                      {
                                        "type": "name",
                                        "value": "timeout_seconds"
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": ["::", "httr", "add_headers"],
                                "args": {
                                  "Accept": {
                                    "type": "literal",
                                    "value": "application/fhir+json"
                                  }
                                }
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "response_time"
                          },
                          {
                            "type": "call",
                            "fun": "*",
                            "args": [
                              {
                                "type": "call",
                                "fun": "as.numeric",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "difftime",
                                    "args": {
                                      "1": {
                                        "type": "call",
                                        "fun": "Sys.time",
                                        "args": []
                                      },
                                      "2": {
                                        "type": "name",
                                        "value": "start_time"
                                      },
                                      "units": {
                                        "type": "literal",
                                        "value": "secs"
                                      }
                                    }
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": 1000
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "==",
                            "args": [
                              {
                                "type": "call",
                                "fun": ["::", "httr", "status_code"],
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "response"
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": 200
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "metadata"
                                  },
                                  {
                                    "type": "call",
                                    "fun": ["::", "httr", "content"],
                                    "args": {
                                      "1": {
                                        "type": "name",
                                        "value": "response"
                                      },
                                      "as": {
                                        "type": "literal",
                                        "value": "parsed"
                                      }
                                    }
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "result"
                                      },
                                      {
                                        "type": "name",
                                        "value": "status"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "if",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "<",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "response_time"
                                          },
                                          {
                                            "type": "literal",
                                            "value": 500
                                          }
                                        ]
                                      },
                                      {
                                        "type": "literal",
                                        "value": "healthy"
                                      },
                                      {
                                        "type": "call",
                                        "fun": "if",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "<",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "response_time"
                                              },
                                              {
                                                "type": "literal",
                                                "value": 2000
                                              }
                                            ]
                                          },
                                          {
                                            "type": "literal",
                                            "value": "warning"
                                          },
                                          {
                                            "type": "literal",
                                            "value": "degraded"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "result"
                                      },
                                      {
                                        "type": "name",
                                        "value": "message"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "sprintf",
                                    "args": [
                                      {
                                        "type": "literal",
                                        "value": "FHIR server responsive (%.0fms)"
                                      },
                                      {
                                        "type": "name",
                                        "value": "response_time"
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "result"
                                      },
                                      {
                                        "type": "name",
                                        "value": "metrics"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "list",
                                    "args": {
                                      "response_time_ms": {
                                        "type": "name",
                                        "value": "response_time"
                                      },
                                      "server_version": {
                                        "type": "call",
                                        "fun": "%||%",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "metadata"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "software"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "name",
                                                "value": "version"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "literal",
                                            "value": "unknown"
                                          }
                                        ]
                                      },
                                      "resource_count": {
                                        "type": "call",
                                        "fun": "%||%",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "length",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "[[",
                                                    "args": [
                                                      {
                                                        "type": "call",
                                                        "fun": "$",
                                                        "args": [
                                                          {
                                                            "type": "name",
                                                            "value": "metadata"
                                                          },
                                                          {
                                                            "type": "name",
                                                            "value": "rest"
                                                          }
                                                        ]
                                                      },
                                                      {
                                                        "type": "literal",
                                                        "value": 1
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "resource"
                                                  }
                                                ]
                                              }
                                            ]
                                          },
                                          {
                                            "type": "literal",
                                            "value": 0
                                          }
                                        ]
                                      }
                                    }
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "result"
                                      },
                                      {
                                        "type": "name",
                                        "value": "status"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "literal",
                                    "value": "degraded"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "result"
                                      },
                                      {
                                        "type": "name",
                                        "value": "message"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "sprintf",
                                    "args": [
                                      {
                                        "type": "literal",
                                        "value": "FHIR server returned status %d"
                                      },
                                      {
                                        "type": "call",
                                        "fun": ["::", "httr", "status_code"],
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "response"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "result"
                                          },
                                          {
                                            "type": "name",
                                            "value": "metrics"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "name",
                                        "value": "status_code"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": ["::", "httr", "status_code"],
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "response"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  "error": {
                    "type": "call",
                    "fun": "function",
                    "args": [
                      {
                        "type": "pairlist",
                        "value": ""
                      },
                      {
                        "type": "call",
                        "fun": "{",
                        "args": [
                          {
                            "type": "call",
                            "fun": "<-",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "name",
                                    "value": "status"
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": "critical"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "<-",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "name",
                                    "value": "message"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "sprintf",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": "FHIR connection failed: %s"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "e"
                                      },
                                      {
                                        "type": "name",
                                        "value": "message"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "NULL",
                        "value": []
                      }
                    ]
                  }
                }
              },
              {
                "type": "call",
                "fun": "return",
                "args": [
                  {
                    "type": "name",
                    "value": "result"
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "check_filesystem_health"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "NULL",
            "value": []
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "result"
                  },
                  {
                    "type": "call",
                    "fun": "list",
                    "args": {
                      "component": {
                        "type": "literal",
                        "value": "filesystem"
                      },
                      "status": {
                        "type": "literal",
                        "value": "unknown"
                      },
                      "message": {
                        "type": "literal",
                        "value": ""
                      },
                      "metrics": {
                        "type": "call",
                        "fun": "list",
                        "args": []
                      },
                      "checked_at": {
                        "type": "call",
                        "fun": "Sys.time",
                        "args": []
                      }
                    }
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "critical_paths"
                  },
                  {
                    "type": "call",
                    "fun": "c",
                    "args": {
                      "config": {
                        "type": "literal",
                        "value": "config/"
                      },
                      "audit": {
                        "type": "literal",
                        "value": "audit/"
                      },
                      "cache": {
                        "type": "literal",
                        "value": "cache/"
                      },
                      "priors": {
                        "type": "literal",
                        "value": "priors/"
                      },
                      "log": {
                        "type": "literal",
                        "value": "log/"
                      }
                    }
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "issues"
                  },
                  {
                    "type": "call",
                    "fun": "character",
                    "args": []
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "metrics"
                  },
                  {
                    "type": "call",
                    "fun": "list",
                    "args": []
                  }
                ]
              },
              {
                "type": "call",
                "fun": "for",
                "args": [
                  {
                    "type": "name",
                    "value": "name"
                  },
                  {
                    "type": "call",
                    "fun": "names",
                    "args": [
                      {
                        "type": "name",
                        "value": "critical_paths"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "path"
                          },
                          {
                            "type": "call",
                            "fun": "[[",
                            "args": [
                              {
                                "type": "name",
                                "value": "critical_paths"
                              },
                              {
                                "type": "name",
                                "value": "name"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "!",
                            "args": [
                              {
                                "type": "call",
                                "fun": "dir.exists",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "path"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "issues"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "c",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "issues"
                                      },
                                      {
                                        "type": "call",
                                        "fun": "sprintf",
                                        "args": [
                                          {
                                            "type": "literal",
                                            "value": "%s directory missing"
                                          },
                                          {
                                            "type": "name",
                                            "value": "name"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "next",
                                "args": []
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "test_file"
                          },
                          {
                            "type": "call",
                            "fun": "file.path",
                            "args": [
                              {
                                "type": "name",
                                "value": "path"
                              },
                              {
                                "type": "literal",
                                "value": ".health_check_test"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "can_write"
                          },
                          {
                            "type": "call",
                            "fun": "tryCatch",
                            "args": {
                              "1": {
                                "type": "call",
                                "fun": "{",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "writeLines",
                                    "args": [
                                      {
                                        "type": "literal",
                                        "value": "test"
                                      },
                                      {
                                        "type": "name",
                                        "value": "test_file"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "file.remove",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "test_file"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "literal",
                                    "value": true
                                  }
                                ]
                              },
                              "error": {
                                "type": "call",
                                "fun": "function",
                                "args": [
                                  {
                                    "type": "pairlist",
                                    "value": ""
                                  },
                                  {
                                    "type": "literal",
                                    "value": false
                                  },
                                  {
                                    "type": "NULL",
                                    "value": []
                                  }
                                ]
                              }
                            }
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "!",
                            "args": [
                              {
                                "type": "name",
                                "value": "can_write"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "issues"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "c",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "issues"
                                      },
                                      {
                                        "type": "call",
                                        "fun": "sprintf",
                                        "args": [
                                          {
                                            "type": "literal",
                                            "value": "%s not writable"
                                          },
                                          {
                                            "type": "name",
                                            "value": "name"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "files"
                          },
                          {
                            "type": "call",
                            "fun": "list.files",
                            "args": {
                              "1": {
                                "type": "name",
                                "value": "path"
                              },
                              "recursive": {
                                "type": "literal",
                                "value": true
                              },
                              "full.names": {
                                "type": "literal",
                                "value": true
                              }
                            }
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": ">",
                            "args": [
                              {
                                "type": "call",
                                "fun": "length",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "files"
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": 0
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "size_mb"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "/",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "sum",
                                        "args": {
                                          "1": {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "file.info",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "files"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "name",
                                                "value": "size"
                                              }
                                            ]
                                          },
                                          "na.rm": {
                                            "type": "literal",
                                            "value": true
                                          }
                                        }
                                      },
                                      {
                                        "type": "call",
                                        "fun": "^",
                                        "args": [
                                          {
                                            "type": "literal",
                                            "value": 1024
                                          },
                                          {
                                            "type": "literal",
                                            "value": 2
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "[[",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "metrics"
                                      },
                                      {
                                        "type": "call",
                                        "fun": "paste0",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "name"
                                          },
                                          {
                                            "type": "literal",
                                            "value": "_size_mb"
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "round",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "size_mb"
                                      },
                                      {
                                        "type": "literal",
                                        "value": 2
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "!=",
                    "args": [
                      {
                        "type": "call",
                        "fun": "[",
                        "args": [
                          {
                            "type": "call",
                            "fun": "Sys.info",
                            "args": []
                          },
                          {
                            "type": "literal",
                            "value": "sysname"
                          }
                        ]
                      },
                      {
                        "type": "literal",
                        "value": "Windows"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "disk_info"
                          },
                          {
                            "type": "call",
                            "fun": "tryCatch",
                            "args": {
                              "1": {
                                "type": "call",
                                "fun": "{",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "[",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "system",
                                        "args": {
                                          "1": {
                                            "type": "literal",
                                            "value": "df -h ."
                                          },
                                          "intern": {
                                            "type": "literal",
                                            "value": true
                                          }
                                        }
                                      },
                                      {
                                        "type": "literal",
                                        "value": 2
                                      }
                                    ]
                                  }
                                ]
                              },
                              "error": {
                                "type": "call",
                                "fun": "function",
                                "args": [
                                  {
                                    "type": "pairlist",
                                    "value": ""
                                  },
                                  {
                                    "type": "NULL",
                                    "value": []
                                  },
                                  {
                                    "type": "NULL",
                                    "value": []
                                  }
                                ]
                              }
                            }
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "!",
                            "args": [
                              {
                                "type": "call",
                                "fun": "is.null",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "disk_info"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "parts"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "[[",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "strsplit",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "disk_info"
                                          },
                                          {
                                            "type": "literal",
                                            "value": "\\s+"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "literal",
                                        "value": 1
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "if",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": ">=",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "length",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "parts"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "literal",
                                        "value": 5
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "{",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "<-",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "use_percent"
                                          },
                                          {
                                            "type": "call",
                                            "fun": "as.numeric",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "sub",
                                                "args": [
                                                  {
                                                    "type": "literal",
                                                    "value": "%"
                                                  },
                                                  {
                                                    "type": "literal",
                                                    "value": ""
                                                  },
                                                  {
                                                    "type": "call",
                                                    "fun": "[",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "parts"
                                                      },
                                                      {
                                                        "type": "literal",
                                                        "value": 5
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "<-",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "metrics"
                                              },
                                              {
                                                "type": "name",
                                                "value": "disk_use_percent"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "name",
                                            "value": "use_percent"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "if",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": ">",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "use_percent"
                                              },
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": ".health_config"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "disk_threshold_percent"
                                                  }
                                                ]
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "{",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "<-",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "issues"
                                                  },
                                                  {
                                                    "type": "call",
                                                    "fun": "c",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "issues"
                                                      },
                                                      {
                                                        "type": "call",
                                                        "fun": "sprintf",
                                                        "args": [
                                                          {
                                                            "type": "literal",
                                                            "value": "Disk usage high: %d%%"
                                                          },
                                                          {
                                                            "type": "name",
                                                            "value": "use_percent"
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": "result"
                      },
                      {
                        "type": "name",
                        "value": "metrics"
                      }
                    ]
                  },
                  {
                    "type": "name",
                    "value": "metrics"
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "==",
                    "args": [
                      {
                        "type": "call",
                        "fun": "length",
                        "args": [
                          {
                            "type": "name",
                            "value": "issues"
                          }
                        ]
                      },
                      {
                        "type": "literal",
                        "value": 0
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "status"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "healthy"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "message"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "File system checks passed"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "if",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<=",
                        "args": [
                          {
                            "type": "call",
                            "fun": "length",
                            "args": [
                              {
                                "type": "name",
                                "value": "issues"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": 2
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "{",
                        "args": [
                          {
                            "type": "call",
                            "fun": "<-",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "name",
                                    "value": "status"
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": "warning"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "<-",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "name",
                                    "value": "message"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "paste",
                                "args": {
                                  "1": {
                                    "type": "name",
                                    "value": "issues"
                                  },
                                  "collapse": {
                                    "type": "literal",
                                    "value": "; "
                                  }
                                }
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "{",
                        "args": [
                          {
                            "type": "call",
                            "fun": "<-",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "name",
                                    "value": "status"
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": "degraded"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "<-",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "name",
                                    "value": "message"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "sprintf",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": "%d file system issues detected"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "length",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "issues"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "return",
                "args": [
                  {
                    "type": "name",
                    "value": "result"
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "check_memory_health"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "NULL",
            "value": []
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "result"
                  },
                  {
                    "type": "call",
                    "fun": "list",
                    "args": {
                      "component": {
                        "type": "literal",
                        "value": "memory"
                      },
                      "status": {
                        "type": "literal",
                        "value": "unknown"
                      },
                      "message": {
                        "type": "literal",
                        "value": ""
                      },
                      "metrics": {
                        "type": "call",
                        "fun": "list",
                        "args": []
                      },
                      "checked_at": {
                        "type": "call",
                        "fun": "Sys.time",
                        "args": []
                      }
                    }
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "gc_info"
                  },
                  {
                    "type": "call",
                    "fun": "gc",
                    "args": []
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "used_mb"
                  },
                  {
                    "type": "call",
                    "fun": "sum",
                    "args": [
                      {
                        "type": "call",
                        "fun": "[",
                        "args": [
                          {
                            "type": "name",
                            "value": "gc_info"
                          },
                          {
                            "type": "name",
                            "value": ""
                          },
                          {
                            "type": "literal",
                            "value": 2
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "max_mb"
                  },
                  {
                    "type": "call",
                    "fun": "sum",
                    "args": [
                      {
                        "type": "call",
                        "fun": "[",
                        "args": [
                          {
                            "type": "name",
                            "value": "gc_info"
                          },
                          {
                            "type": "name",
                            "value": ""
                          },
                          {
                            "type": "literal",
                            "value": 6
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": "result"
                      },
                      {
                        "type": "name",
                        "value": "metrics"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "list",
                    "args": {
                      "used_mb": {
                        "type": "call",
                        "fun": "round",
                        "args": [
                          {
                            "type": "name",
                            "value": "used_mb"
                          },
                          {
                            "type": "literal",
                            "value": 2
                          }
                        ]
                      },
                      "max_mb": {
                        "type": "call",
                        "fun": "round",
                        "args": [
                          {
                            "type": "name",
                            "value": "max_mb"
                          },
                          {
                            "type": "literal",
                            "value": 2
                          }
                        ]
                      },
                      "ncells": {
                        "type": "call",
                        "fun": "[",
                        "args": [
                          {
                            "type": "name",
                            "value": "gc_info"
                          },
                          {
                            "type": "literal",
                            "value": 1
                          },
                          {
                            "type": "literal",
                            "value": 1
                          }
                        ]
                      },
                      "vcells": {
                        "type": "call",
                        "fun": "[",
                        "args": [
                          {
                            "type": "name",
                            "value": "gc_info"
                          },
                          {
                            "type": "literal",
                            "value": 2
                          },
                          {
                            "type": "literal",
                            "value": 1
                          }
                        ]
                      }
                    }
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "<",
                    "args": [
                      {
                        "type": "name",
                        "value": "used_mb"
                      },
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": ".health_config"
                          },
                          {
                            "type": "name",
                            "value": "memory_threshold_mb"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "status"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "healthy"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "message"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "sprintf",
                            "args": [
                              {
                                "type": "literal",
                                "value": "Memory usage normal (%.0f MB)"
                              },
                              {
                                "type": "name",
                                "value": "used_mb"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "if",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<",
                        "args": [
                          {
                            "type": "name",
                            "value": "used_mb"
                          },
                          {
                            "type": "call",
                            "fun": "*",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": ".health_config"
                                  },
                                  {
                                    "type": "name",
                                    "value": "memory_threshold_mb"
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": 1.5
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "{",
                        "args": [
                          {
                            "type": "call",
                            "fun": "<-",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "name",
                                    "value": "status"
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": "warning"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "<-",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "name",
                                    "value": "message"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "sprintf",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": "Memory usage elevated (%.0f MB)"
                                  },
                                  {
                                    "type": "name",
                                    "value": "used_mb"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "{",
                        "args": [
                          {
                            "type": "call",
                            "fun": "<-",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "name",
                                    "value": "status"
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": "degraded"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "<-",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "name",
                                    "value": "message"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "sprintf",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": "Memory usage high (%.0f MB)"
                                  },
                                  {
                                    "type": "name",
                                    "value": "used_mb"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "return",
                "args": [
                  {
                    "type": "name",
                    "value": "result"
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "check_api_health"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "NULL",
            "value": []
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "result"
                  },
                  {
                    "type": "call",
                    "fun": "list",
                    "args": {
                      "component": {
                        "type": "literal",
                        "value": "api"
                      },
                      "status": {
                        "type": "literal",
                        "value": "unknown"
                      },
                      "message": {
                        "type": "literal",
                        "value": ""
                      },
                      "metrics": {
                        "type": "call",
                        "fun": "list",
                        "args": []
                      },
                      "checked_at": {
                        "type": "call",
                        "fun": "Sys.time",
                        "args": []
                      }
                    }
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "api_port"
                  },
                  {
                    "type": "call",
                    "fun": "as.integer",
                    "args": [
                      {
                        "type": "call",
                        "fun": "Sys.getenv",
                        "args": [
                          {
                            "type": "literal",
                            "value": "API_PORT"
                          },
                          {
                            "type": "literal",
                            "value": "8000"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "api_url"
                  },
                  {
                    "type": "call",
                    "fun": "sprintf",
                    "args": [
                      {
                        "type": "literal",
                        "value": "http://localhost:%d/healthz"
                      },
                      {
                        "type": "name",
                        "value": "api_port"
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "tryCatch",
                "args": {
                  "1": {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "start_time"
                          },
                          {
                            "type": "call",
                            "fun": "Sys.time",
                            "args": []
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "response"
                          },
                          {
                            "type": "call",
                            "fun": ["::", "httr", "GET"],
                            "args": [
                              {
                                "type": "name",
                                "value": "api_url"
                              },
                              {
                                "type": "call",
                                "fun": ["::", "httr", "timeout"],
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": ".health_config"
                                      },
                                      {
                                        "type": "name",
                                        "value": "timeout_seconds"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "response_time"
                          },
                          {
                            "type": "call",
                            "fun": "*",
                            "args": [
                              {
                                "type": "call",
                                "fun": "as.numeric",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "difftime",
                                    "args": {
                                      "1": {
                                        "type": "call",
                                        "fun": "Sys.time",
                                        "args": []
                                      },
                                      "2": {
                                        "type": "name",
                                        "value": "start_time"
                                      },
                                      "units": {
                                        "type": "literal",
                                        "value": "secs"
                                      }
                                    }
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": 1000
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "==",
                            "args": [
                              {
                                "type": "call",
                                "fun": ["::", "httr", "status_code"],
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "response"
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": 200
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "content"
                                  },
                                  {
                                    "type": "call",
                                    "fun": ["::", "httr", "content"],
                                    "args": {
                                      "1": {
                                        "type": "name",
                                        "value": "response"
                                      },
                                      "as": {
                                        "type": "literal",
                                        "value": "parsed"
                                      }
                                    }
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "result"
                                      },
                                      {
                                        "type": "name",
                                        "value": "status"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "if",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "<",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "response_time"
                                          },
                                          {
                                            "type": "literal",
                                            "value": 100
                                          }
                                        ]
                                      },
                                      {
                                        "type": "literal",
                                        "value": "healthy"
                                      },
                                      {
                                        "type": "call",
                                        "fun": "if",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "<",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "response_time"
                                              },
                                              {
                                                "type": "literal",
                                                "value": 500
                                              }
                                            ]
                                          },
                                          {
                                            "type": "literal",
                                            "value": "warning"
                                          },
                                          {
                                            "type": "literal",
                                            "value": "degraded"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "result"
                                      },
                                      {
                                        "type": "name",
                                        "value": "message"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "sprintf",
                                    "args": [
                                      {
                                        "type": "literal",
                                        "value": "API responsive (%.0fms)"
                                      },
                                      {
                                        "type": "name",
                                        "value": "response_time"
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "result"
                                      },
                                      {
                                        "type": "name",
                                        "value": "metrics"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "list",
                                    "args": {
                                      "response_time_ms": {
                                        "type": "name",
                                        "value": "response_time"
                                      },
                                      "api_status": {
                                        "type": "call",
                                        "fun": "%||%",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "content"
                                              },
                                              {
                                                "type": "name",
                                                "value": "status"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "literal",
                                            "value": "unknown"
                                          }
                                        ]
                                      }
                                    }
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "result"
                                      },
                                      {
                                        "type": "name",
                                        "value": "status"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "literal",
                                    "value": "degraded"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "result"
                                      },
                                      {
                                        "type": "name",
                                        "value": "message"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "sprintf",
                                    "args": [
                                      {
                                        "type": "literal",
                                        "value": "API returned status %d"
                                      },
                                      {
                                        "type": "call",
                                        "fun": ["::", "httr", "status_code"],
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "response"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  "error": {
                    "type": "call",
                    "fun": "function",
                    "args": [
                      {
                        "type": "pairlist",
                        "value": ""
                      },
                      {
                        "type": "call",
                        "fun": "{",
                        "args": [
                          {
                            "type": "call",
                            "fun": "<-",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "name",
                                    "value": "status"
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": "warning"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "<-",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "name",
                                    "value": "message"
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": "API not available (may not be running)"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "NULL",
                        "value": []
                      }
                    ]
                  }
                }
              },
              {
                "type": "call",
                "fun": "return",
                "args": [
                  {
                    "type": "name",
                    "value": "result"
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "check_auth_health"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "NULL",
            "value": []
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "result"
                  },
                  {
                    "type": "call",
                    "fun": "list",
                    "args": {
                      "component": {
                        "type": "literal",
                        "value": "auth"
                      },
                      "status": {
                        "type": "literal",
                        "value": "unknown"
                      },
                      "message": {
                        "type": "literal",
                        "value": ""
                      },
                      "metrics": {
                        "type": "call",
                        "fun": "list",
                        "args": []
                      },
                      "checked_at": {
                        "type": "call",
                        "fun": "Sys.time",
                        "args": []
                      }
                    }
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "users_file"
                  },
                  {
                    "type": "literal",
                    "value": "config/users.yaml"
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "!",
                    "args": [
                      {
                        "type": "call",
                        "fun": "file.exists",
                        "args": [
                          {
                            "type": "name",
                            "value": "users_file"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "status"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "warning"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "message"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "Users configuration not found"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "return",
                        "args": [
                          {
                            "type": "name",
                            "value": "result"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "tryCatch",
                "args": {
                  "1": {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "users"
                          },
                          {
                            "type": "call",
                            "fun": ["::", "yaml", "read_yaml"],
                            "args": [
                              {
                                "type": "name",
                                "value": "users_file"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "user_count"
                          },
                          {
                            "type": "call",
                            "fun": "length",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "users"
                                  },
                                  {
                                    "type": "name",
                                    "value": "users"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "has_admin"
                          },
                          {
                            "type": "call",
                            "fun": "any",
                            "args": [
                              {
                                "type": "call",
                                "fun": "sapply",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "users"
                                      },
                                      {
                                        "type": "name",
                                        "value": "users"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "function",
                                    "args": [
                                      {
                                        "type": "pairlist",
                                        "value": ""
                                      },
                                      {
                                        "type": "call",
                                        "fun": "==",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "u"
                                              },
                                              {
                                                "type": "name",
                                                "value": "role"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "literal",
                                            "value": "admin"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "NULL",
                                        "value": []
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "has_plain_passwords"
                          },
                          {
                            "type": "call",
                            "fun": "any",
                            "args": [
                              {
                                "type": "call",
                                "fun": "sapply",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "users"
                                      },
                                      {
                                        "type": "name",
                                        "value": "users"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "function",
                                    "args": [
                                      {
                                        "type": "pairlist",
                                        "value": ""
                                      },
                                      {
                                        "type": "call",
                                        "fun": "!",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "is.null",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "u"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "password"
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      },
                                      {
                                        "type": "NULL",
                                        "value": []
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "name",
                            "value": "has_plain_passwords"
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "result"
                                      },
                                      {
                                        "type": "name",
                                        "value": "status"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "literal",
                                    "value": "critical"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "result"
                                      },
                                      {
                                        "type": "name",
                                        "value": "message"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "literal",
                                    "value": "Plain text passwords detected - security risk!"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "if",
                            "args": [
                              {
                                "type": "call",
                                "fun": "!",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "has_admin"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "{",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "<-",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "result"
                                          },
                                          {
                                            "type": "name",
                                            "value": "status"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "literal",
                                        "value": "warning"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "<-",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "result"
                                          },
                                          {
                                            "type": "name",
                                            "value": "message"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "literal",
                                        "value": "No admin user configured"
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "{",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "<-",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "result"
                                          },
                                          {
                                            "type": "name",
                                            "value": "status"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "literal",
                                        "value": "healthy"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "<-",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "result"
                                          },
                                          {
                                            "type": "name",
                                            "value": "message"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "sprintf",
                                        "args": [
                                          {
                                            "type": "literal",
                                            "value": "%d users configured"
                                          },
                                          {
                                            "type": "name",
                                            "value": "user_count"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "metrics"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "list",
                            "args": {
                              "user_count": {
                                "type": "name",
                                "value": "user_count"
                              },
                              "has_admin": {
                                "type": "name",
                                "value": "has_admin"
                              },
                              "has_plain_passwords": {
                                "type": "name",
                                "value": "has_plain_passwords"
                              }
                            }
                          }
                        ]
                      }
                    ]
                  },
                  "error": {
                    "type": "call",
                    "fun": "function",
                    "args": [
                      {
                        "type": "pairlist",
                        "value": ""
                      },
                      {
                        "type": "call",
                        "fun": "{",
                        "args": [
                          {
                            "type": "call",
                            "fun": "<-",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "name",
                                    "value": "status"
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": "critical"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "<-",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "name",
                                    "value": "message"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "sprintf",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": "Failed to load users: %s"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "e"
                                      },
                                      {
                                        "type": "name",
                                        "value": "message"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "NULL",
                        "value": []
                      }
                    ]
                  }
                }
              },
              {
                "type": "call",
                "fun": "return",
                "args": [
                  {
                    "type": "name",
                    "value": "result"
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "check_cache_health"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "NULL",
            "value": []
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "result"
                  },
                  {
                    "type": "call",
                    "fun": "list",
                    "args": {
                      "component": {
                        "type": "literal",
                        "value": "cache"
                      },
                      "status": {
                        "type": "literal",
                        "value": "unknown"
                      },
                      "message": {
                        "type": "literal",
                        "value": ""
                      },
                      "metrics": {
                        "type": "call",
                        "fun": "list",
                        "args": []
                      },
                      "checked_at": {
                        "type": "call",
                        "fun": "Sys.time",
                        "args": []
                      }
                    }
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "cache_dir"
                  },
                  {
                    "type": "literal",
                    "value": "cache/"
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "!",
                    "args": [
                      {
                        "type": "call",
                        "fun": "dir.exists",
                        "args": [
                          {
                            "type": "name",
                            "value": "cache_dir"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "status"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "warning"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "message"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "Cache directory missing"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "return",
                        "args": [
                          {
                            "type": "name",
                            "value": "result"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "cache_files"
                  },
                  {
                    "type": "call",
                    "fun": "list.files",
                    "args": {
                      "1": {
                        "type": "name",
                        "value": "cache_dir"
                      },
                      "pattern": {
                        "type": "literal",
                        "value": "\\.rds$"
                      },
                      "full.names": {
                        "type": "literal",
                        "value": true
                      }
                    }
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "==",
                    "args": [
                      {
                        "type": "call",
                        "fun": "length",
                        "args": [
                          {
                            "type": "name",
                            "value": "cache_files"
                          }
                        ]
                      },
                      {
                        "type": "literal",
                        "value": 0
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "status"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "healthy"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "message"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "Cache empty"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "metrics"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "list",
                            "args": {
                              "entries": {
                                "type": "literal",
                                "value": 0
                              },
                              "size_mb": {
                                "type": "literal",
                                "value": 0
                              }
                            }
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "return",
                        "args": [
                          {
                            "type": "name",
                            "value": "result"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "cache_info"
                  },
                  {
                    "type": "call",
                    "fun": "file.info",
                    "args": [
                      {
                        "type": "name",
                        "value": "cache_files"
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "total_size_mb"
                  },
                  {
                    "type": "call",
                    "fun": "/",
                    "args": [
                      {
                        "type": "call",
                        "fun": "sum",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "cache_info"
                              },
                              {
                                "type": "name",
                                "value": "size"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "^",
                        "args": [
                          {
                            "type": "literal",
                            "value": 1024
                          },
                          {
                            "type": "literal",
                            "value": 2
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "cache_ages"
                  },
                  {
                    "type": "call",
                    "fun": "difftime",
                    "args": {
                      "1": {
                        "type": "call",
                        "fun": "Sys.time",
                        "args": []
                      },
                      "2": {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "cache_info"
                          },
                          {
                            "type": "name",
                            "value": "mtime"
                          }
                        ]
                      },
                      "units": {
                        "type": "literal",
                        "value": "hours"
                      }
                    }
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "old_entries"
                  },
                  {
                    "type": "call",
                    "fun": "sum",
                    "args": [
                      {
                        "type": "call",
                        "fun": ">",
                        "args": [
                          {
                            "type": "name",
                            "value": "cache_ages"
                          },
                          {
                            "type": "literal",
                            "value": 24
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": "result"
                      },
                      {
                        "type": "name",
                        "value": "metrics"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "list",
                    "args": {
                      "entries": {
                        "type": "call",
                        "fun": "length",
                        "args": [
                          {
                            "type": "name",
                            "value": "cache_files"
                          }
                        ]
                      },
                      "size_mb": {
                        "type": "call",
                        "fun": "round",
                        "args": [
                          {
                            "type": "name",
                            "value": "total_size_mb"
                          },
                          {
                            "type": "literal",
                            "value": 2
                          }
                        ]
                      },
                      "oldest_hours": {
                        "type": "call",
                        "fun": "round",
                        "args": [
                          {
                            "type": "call",
                            "fun": "max",
                            "args": [
                              {
                                "type": "name",
                                "value": "cache_ages"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": 1
                          }
                        ]
                      },
                      "old_entries": {
                        "type": "name",
                        "value": "old_entries"
                      }
                    }
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": ">",
                    "args": [
                      {
                        "type": "name",
                        "value": "old_entries"
                      },
                      {
                        "type": "call",
                        "fun": "*",
                        "args": [
                          {
                            "type": "call",
                            "fun": "length",
                            "args": [
                              {
                                "type": "name",
                                "value": "cache_files"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": 0.5
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "status"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "warning"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "message"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "sprintf",
                            "args": [
                              {
                                "type": "literal",
                                "value": "Many stale cache entries (%d/%d > 24h old)"
                              },
                              {
                                "type": "name",
                                "value": "old_entries"
                              },
                              {
                                "type": "call",
                                "fun": "length",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "cache_files"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "status"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "healthy"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "message"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "sprintf",
                            "args": [
                              {
                                "type": "literal",
                                "value": "Cache healthy (%d entries, %.1f MB)"
                              },
                              {
                                "type": "call",
                                "fun": "length",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "cache_files"
                                  }
                                ]
                              },
                              {
                                "type": "name",
                                "value": "total_size_mb"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "return",
                "args": [
                  {
                    "type": "name",
                    "value": "result"
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "check_audit_health"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "NULL",
            "value": []
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "result"
                  },
                  {
                    "type": "call",
                    "fun": "list",
                    "args": {
                      "component": {
                        "type": "literal",
                        "value": "audit"
                      },
                      "status": {
                        "type": "literal",
                        "value": "unknown"
                      },
                      "message": {
                        "type": "literal",
                        "value": ""
                      },
                      "metrics": {
                        "type": "call",
                        "fun": "list",
                        "args": []
                      },
                      "checked_at": {
                        "type": "call",
                        "fun": "Sys.time",
                        "args": []
                      }
                    }
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "audit_file"
                  },
                  {
                    "type": "literal",
                    "value": "audit/audit_log.csv"
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "!",
                    "args": [
                      {
                        "type": "call",
                        "fun": "file.exists",
                        "args": [
                          {
                            "type": "name",
                            "value": "audit_file"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "status"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "warning"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "message"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "Audit log not initialized"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "return",
                        "args": [
                          {
                            "type": "name",
                            "value": "result"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "tryCatch",
                "args": {
                  "1": {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "file_size_mb"
                          },
                          {
                            "type": "call",
                            "fun": "/",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "file.info",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "audit_file"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "name",
                                    "value": "size"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "^",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": 1024
                                  },
                                  {
                                    "type": "literal",
                                    "value": 2
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "audit_data"
                          },
                          {
                            "type": "call",
                            "fun": ["::", "utils", "tail"],
                            "args": [
                              {
                                "type": "call",
                                "fun": "read.csv",
                                "args": {
                                  "1": {
                                    "type": "name",
                                    "value": "audit_file"
                                  },
                                  "stringsAsFactors": {
                                    "type": "literal",
                                    "value": false
                                  }
                                }
                              },
                              {
                                "type": "literal",
                                "value": 100
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "entries_today"
                          },
                          {
                            "type": "call",
                            "fun": "sum",
                            "args": [
                              {
                                "type": "call",
                                "fun": "==",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "as.Date",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "audit_data"
                                          },
                                          {
                                            "type": "name",
                                            "value": "timestamp"
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "Sys.Date",
                                    "args": []
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "unique_users"
                          },
                          {
                            "type": "call",
                            "fun": "length",
                            "args": [
                              {
                                "type": "call",
                                "fun": "unique",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "audit_data"
                                      },
                                      {
                                        "type": "name",
                                        "value": "user"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "metrics"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "list",
                            "args": {
                              "file_size_mb": {
                                "type": "call",
                                "fun": "round",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "file_size_mb"
                                  },
                                  {
                                    "type": "literal",
                                    "value": 2
                                  }
                                ]
                              },
                              "total_entries": {
                                "type": "call",
                                "fun": "nrow",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "audit_data"
                                  }
                                ]
                              },
                              "entries_today": {
                                "type": "name",
                                "value": "entries_today"
                              },
                              "unique_users": {
                                "type": "name",
                                "value": "unique_users"
                              }
                            }
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": ">",
                            "args": [
                              {
                                "type": "name",
                                "value": "file_size_mb"
                              },
                              {
                                "type": "literal",
                                "value": 100
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "result"
                                      },
                                      {
                                        "type": "name",
                                        "value": "status"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "literal",
                                    "value": "warning"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "result"
                                      },
                                      {
                                        "type": "name",
                                        "value": "message"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "sprintf",
                                    "args": [
                                      {
                                        "type": "literal",
                                        "value": "Audit log large (%.1f MB) - consider archiving"
                                      },
                                      {
                                        "type": "name",
                                        "value": "file_size_mb"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "result"
                                      },
                                      {
                                        "type": "name",
                                        "value": "status"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "literal",
                                    "value": "healthy"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "result"
                                      },
                                      {
                                        "type": "name",
                                        "value": "message"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "sprintf",
                                    "args": [
                                      {
                                        "type": "literal",
                                        "value": "Audit system operational (%d entries today)"
                                      },
                                      {
                                        "type": "name",
                                        "value": "entries_today"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  "error": {
                    "type": "call",
                    "fun": "function",
                    "args": [
                      {
                        "type": "pairlist",
                        "value": ""
                      },
                      {
                        "type": "call",
                        "fun": "{",
                        "args": [
                          {
                            "type": "call",
                            "fun": "<-",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "name",
                                    "value": "status"
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": "degraded"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "<-",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "name",
                                    "value": "message"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "sprintf",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": "Cannot read audit log: %s"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "e"
                                      },
                                      {
                                        "type": "name",
                                        "value": "message"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "NULL",
                        "value": []
                      }
                    ]
                  }
                }
              },
              {
                "type": "call",
                "fun": "return",
                "args": [
                  {
                    "type": "name",
                    "value": "result"
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "check_model_health"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "NULL",
            "value": []
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "result"
                  },
                  {
                    "type": "call",
                    "fun": "list",
                    "args": {
                      "component": {
                        "type": "literal",
                        "value": "models"
                      },
                      "status": {
                        "type": "literal",
                        "value": "unknown"
                      },
                      "message": {
                        "type": "literal",
                        "value": ""
                      },
                      "metrics": {
                        "type": "call",
                        "fun": "list",
                        "args": []
                      },
                      "checked_at": {
                        "type": "call",
                        "fun": "Sys.time",
                        "args": []
                      }
                    }
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "required_models"
                  },
                  {
                    "type": "call",
                    "fun": "c",
                    "args": [
                      {
                        "type": "literal",
                        "value": "pk_1cpt"
                      },
                      {
                        "type": "literal",
                        "value": "pk_2cpt"
                      },
                      {
                        "type": "literal",
                        "value": "pk_3cpt"
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "stan_dir"
                  },
                  {
                    "type": "literal",
                    "value": "models/stan/"
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "stan_available"
                  },
                  {
                    "type": "call",
                    "fun": "dir.exists",
                    "args": [
                      {
                        "type": "name",
                        "value": "stan_dir"
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "jags_dir"
                  },
                  {
                    "type": "literal",
                    "value": "models/jags/"
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "jags_available"
                  },
                  {
                    "type": "call",
                    "fun": "dir.exists",
                    "args": [
                      {
                        "type": "name",
                        "value": "jags_dir"
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "&&",
                    "args": [
                      {
                        "type": "call",
                        "fun": "!",
                        "args": [
                          {
                            "type": "name",
                            "value": "stan_available"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "!",
                        "args": [
                          {
                            "type": "name",
                            "value": "jags_available"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "status"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "critical"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "message"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "No model directories found"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "return",
                        "args": [
                          {
                            "type": "name",
                            "value": "result"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "missing"
                  },
                  {
                    "type": "call",
                    "fun": "character",
                    "args": []
                  }
                ]
              },
              {
                "type": "call",
                "fun": "for",
                "args": [
                  {
                    "type": "name",
                    "value": "model"
                  },
                  {
                    "type": "name",
                    "value": "required_models"
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "stan_file"
                          },
                          {
                            "type": "call",
                            "fun": "file.path",
                            "args": [
                              {
                                "type": "name",
                                "value": "stan_dir"
                              },
                              {
                                "type": "call",
                                "fun": "paste0",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "model"
                                  },
                                  {
                                    "type": "literal",
                                    "value": ".stan"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "jags_file"
                          },
                          {
                            "type": "call",
                            "fun": "file.path",
                            "args": [
                              {
                                "type": "name",
                                "value": "jags_dir"
                              },
                              {
                                "type": "call",
                                "fun": "paste0",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "model"
                                  },
                                  {
                                    "type": "literal",
                                    "value": ".bug"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "&&",
                            "args": [
                              {
                                "type": "call",
                                "fun": "!",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "file.exists",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "stan_file"
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "!",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "file.exists",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "jags_file"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "missing"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "c",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "missing"
                                      },
                                      {
                                        "type": "name",
                                        "value": "model"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": "result"
                      },
                      {
                        "type": "name",
                        "value": "metrics"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "list",
                    "args": {
                      "models_found": {
                        "type": "call",
                        "fun": "-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "length",
                            "args": [
                              {
                                "type": "name",
                                "value": "required_models"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "length",
                            "args": [
                              {
                                "type": "name",
                                "value": "missing"
                              }
                            ]
                          }
                        ]
                      },
                      "models_missing": {
                        "type": "call",
                        "fun": "length",
                        "args": [
                          {
                            "type": "name",
                            "value": "missing"
                          }
                        ]
                      },
                      "stan_available": {
                        "type": "name",
                        "value": "stan_available"
                      },
                      "jags_available": {
                        "type": "name",
                        "value": "jags_available"
                      }
                    }
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": ">",
                    "args": [
                      {
                        "type": "call",
                        "fun": "length",
                        "args": [
                          {
                            "type": "name",
                            "value": "missing"
                          }
                        ]
                      },
                      {
                        "type": "literal",
                        "value": 0
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "status"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "degraded"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "result"
                              },
                              {
                                "type": "name",
                                "value": "message"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "sprintf",
                            "args": [
                              {
                                "type": "literal",
                                "value": "Missing models: %s"
                              },
                              {
                                "type": "call",
                                "fun": "paste",
                                "args": {
                                  "1": {
                                    "type": "name",
                                    "value": "missing"
                                  },
                                  "collapse": {
                                    "type": "literal",
                                    "value": ", "
                                  }
                                }
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "if",
                    "args": [
                      {
                        "type": "call",
                        "fun": "||",
                        "args": [
                          {
                            "type": "call",
                            "fun": "!",
                            "args": [
                              {
                                "type": "name",
                                "value": "stan_available"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "!",
                            "args": [
                              {
                                "type": "name",
                                "value": "jags_available"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "{",
                        "args": [
                          {
                            "type": "call",
                            "fun": "<-",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "name",
                                    "value": "status"
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": "warning"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "<-",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "name",
                                    "value": "message"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "sprintf",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": "Backend missing - Stan: %s, JAGS: %s"
                                  },
                                  {
                                    "type": "name",
                                    "value": "stan_available"
                                  },
                                  {
                                    "type": "name",
                                    "value": "jags_available"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "{",
                        "args": [
                          {
                            "type": "call",
                            "fun": "<-",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "name",
                                    "value": "status"
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": "healthy"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "<-",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "name",
                                    "value": "message"
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": "All models and backends available"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "return",
                "args": [
                  {
                    "type": "name",
                    "value": "result"
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "get_health_status"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "NULL",
            "value": []
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "is.null",
                    "args": [
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": ".health_status"
                          },
                          {
                            "type": "name",
                            "value": "current"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "run_health_checks",
                        "args": {
                          "verbose": {
                            "type": "literal",
                            "value": false
                          }
                        }
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "$",
                "args": [
                  {
                    "type": "name",
                    "value": ".health_status"
                  },
                  {
                    "type": "name",
                    "value": "current"
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "get_health_history"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": "10"
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "history"
                  },
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": ".health_status"
                      },
                      {
                        "type": "name",
                        "value": "history"
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "==",
                    "args": [
                      {
                        "type": "call",
                        "fun": "length",
                        "args": [
                          {
                            "type": "name",
                            "value": "history"
                          }
                        ]
                      },
                      {
                        "type": "literal",
                        "value": 0
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "return",
                        "args": [
                          {
                            "type": "call",
                            "fun": "data.frame",
                            "args": []
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": ">",
                    "args": [
                      {
                        "type": "call",
                        "fun": "length",
                        "args": [
                          {
                            "type": "name",
                            "value": "history"
                          }
                        ]
                      },
                      {
                        "type": "name",
                        "value": "limit"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "history"
                          },
                          {
                            "type": "call",
                            "fun": "[",
                            "args": [
                              {
                                "type": "name",
                                "value": "history"
                              },
                              {
                                "type": "call",
                                "fun": ":",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": 1
                                  },
                                  {
                                    "type": "name",
                                    "value": "limit"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "do.call",
                "args": [
                  {
                    "type": "name",
                    "value": "rbind"
                  },
                  {
                    "type": "call",
                    "fun": "lapply",
                    "args": [
                      {
                        "type": "name",
                        "value": "history"
                      },
                      {
                        "type": "call",
                        "fun": "function",
                        "args": [
                          {
                            "type": "pairlist",
                            "value": ""
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "data.frame",
                                "args": {
                                  "timestamp": {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "h"
                                      },
                                      {
                                        "type": "name",
                                        "value": "timestamp"
                                      }
                                    ]
                                  },
                                  "overall_status": {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "h"
                                      },
                                      {
                                        "type": "name",
                                        "value": "overall_status"
                                      }
                                    ]
                                  },
                                  "duration_ms": {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "h"
                                      },
                                      {
                                        "type": "name",
                                        "value": "duration_ms"
                                      }
                                    ]
                                  },
                                  "healthy": {
                                    "type": "call",
                                    "fun": "sum",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "sapply",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "h"
                                              },
                                              {
                                                "type": "name",
                                                "value": "checks"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "function",
                                            "args": [
                                              {
                                                "type": "pairlist",
                                                "value": ""
                                              },
                                              {
                                                "type": "call",
                                                "fun": "==",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "c"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": "status"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "type": "literal",
                                                    "value": "healthy"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "NULL",
                                                "value": []
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  "warning": {
                                    "type": "call",
                                    "fun": "sum",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "sapply",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "h"
                                              },
                                              {
                                                "type": "name",
                                                "value": "checks"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "function",
                                            "args": [
                                              {
                                                "type": "pairlist",
                                                "value": ""
                                              },
                                              {
                                                "type": "call",
                                                "fun": "==",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "c"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": "status"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "type": "literal",
                                                    "value": "warning"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "NULL",
                                                "value": []
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  "degraded": {
                                    "type": "call",
                                    "fun": "sum",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "sapply",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "h"
                                              },
                                              {
                                                "type": "name",
                                                "value": "checks"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "function",
                                            "args": [
                                              {
                                                "type": "pairlist",
                                                "value": ""
                                              },
                                              {
                                                "type": "call",
                                                "fun": "==",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "c"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": "status"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "type": "literal",
                                                    "value": "degraded"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "NULL",
                                                "value": []
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  "critical": {
                                    "type": "call",
                                    "fun": "sum",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "sapply",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "h"
                                              },
                                              {
                                                "type": "name",
                                                "value": "checks"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "function",
                                            "args": [
                                              {
                                                "type": "pairlist",
                                                "value": ""
                                              },
                                              {
                                                "type": "call",
                                                "fun": "==",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "c"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": "status"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "type": "literal",
                                                    "value": "critical"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "NULL",
                                                "value": []
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  "stringsAsFactors": {
                                    "type": "literal",
                                    "value": false
                                  }
                                }
                              }
                            ]
                          },
                          {
                            "type": "NULL",
                            "value": []
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "print_health_summary"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": ""
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "cat",
                "args": [
                  {
                    "type": "literal",
                    "value": "\n========== SYSTEM HEALTH CHECK ==========\n"
                  }
                ]
              },
              {
                "type": "call",
                "fun": "cat",
                "args": [
                  {
                    "type": "call",
                    "fun": "sprintf",
                    "args": [
                      {
                        "type": "literal",
                        "value": "Timestamp: %s\n"
                      },
                      {
                        "type": "call",
                        "fun": "format",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "results"
                              },
                              {
                                "type": "name",
                                "value": "timestamp"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "%Y-%m-%d %H:%M:%S"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "cat",
                "args": [
                  {
                    "type": "call",
                    "fun": "sprintf",
                    "args": [
                      {
                        "type": "literal",
                        "value": "Overall Status: %s\n"
                      },
                      {
                        "type": "call",
                        "fun": "toupper",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "results"
                              },
                              {
                                "type": "name",
                                "value": "overall_status"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "cat",
                "args": [
                  {
                    "type": "call",
                    "fun": "sprintf",
                    "args": [
                      {
                        "type": "literal",
                        "value": "Duration: %.0f ms\n\n"
                      },
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "results"
                          },
                          {
                            "type": "name",
                            "value": "duration_ms"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "cat",
                "args": [
                  {
                    "type": "literal",
                    "value": "Component Status:\n"
                  }
                ]
              },
              {
                "type": "call",
                "fun": "cat",
                "args": [
                  {
                    "type": "literal",
                    "value": "-----------------\n"
                  }
                ]
              },
              {
                "type": "call",
                "fun": "for",
                "args": [
                  {
                    "type": "name",
                    "value": "check_name"
                  },
                  {
                    "type": "call",
                    "fun": "names",
                    "args": [
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "results"
                          },
                          {
                            "type": "name",
                            "value": "checks"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "check"
                          },
                          {
                            "type": "call",
                            "fun": "[[",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "results"
                                  },
                                  {
                                    "type": "name",
                                    "value": "checks"
                                  }
                                ]
                              },
                              {
                                "type": "name",
                                "value": "check_name"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "status_symbol"
                          },
                          {
                            "type": "call",
                            "fun": "switch",
                            "args": {
                              "1": {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "check"
                                  },
                                  {
                                    "type": "name",
                                    "value": "status"
                                  }
                                ]
                              },
                              "healthy": {
                                "type": "literal",
                                "value": ""
                              },
                              "warning": {
                                "type": "literal",
                                "value": ""
                              },
                              "degraded": {
                                "type": "literal",
                                "value": ""
                              },
                              "critical": {
                                "type": "literal",
                                "value": ""
                              },
                              "unknown": {
                                "type": "literal",
                                "value": "?"
                              }
                            }
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "cat",
                        "args": [
                          {
                            "type": "call",
                            "fun": "sprintf",
                            "args": [
                              {
                                "type": "literal",
                                "value": "  %s %-15s: %-8s - %s\n"
                              },
                              {
                                "type": "name",
                                "value": "status_symbol"
                              },
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "check"
                                  },
                                  {
                                    "type": "name",
                                    "value": "component"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "toupper",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "check"
                                      },
                                      {
                                        "type": "name",
                                        "value": "status"
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "check"
                                  },
                                  {
                                    "type": "name",
                                    "value": "message"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "cat",
                "args": [
                  {
                    "type": "literal",
                    "value": "\n==========================================\n"
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "log_critical_health_issues"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": ""
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "critical_components"
                  },
                  {
                    "type": "call",
                    "fun": "names",
                    "args": [
                      {
                        "type": "call",
                        "fun": "Filter",
                        "args": [
                          {
                            "type": "call",
                            "fun": "function",
                            "args": [
                              {
                                "type": "pairlist",
                                "value": ""
                              },
                              {
                                "type": "call",
                                "fun": "==",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "x"
                                      },
                                      {
                                        "type": "name",
                                        "value": "status"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "literal",
                                    "value": "critical"
                                  }
                                ]
                              },
                              {
                                "type": "NULL",
                                "value": []
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "results"
                              },
                              {
                                "type": "name",
                                "value": "checks"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": ">",
                    "args": [
                      {
                        "type": "call",
                        "fun": "length",
                        "args": [
                          {
                            "type": "name",
                            "value": "critical_components"
                          }
                        ]
                      },
                      {
                        "type": "literal",
                        "value": 0
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "exists",
                            "args": [
                              {
                                "type": "literal",
                                "value": "log_error"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "for",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "component"
                                  },
                                  {
                                    "type": "name",
                                    "value": "critical_components"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "{",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "<-",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "check"
                                          },
                                          {
                                            "type": "call",
                                            "fun": "[[",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "results"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "checks"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "name",
                                                "value": "component"
                                              }
                                            ]
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "log_error",
                                        "args": {
                                          "error_type": {
                                            "type": "literal",
                                            "value": "HEALTH_CHECK_CRITICAL"
                                          },
                                          "message": {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "check"
                                              },
                                              {
                                                "type": "name",
                                                "value": "message"
                                              }
                                            ]
                                          },
                                          "severity": {
                                            "type": "literal",
                                            "value": "CRITICAL"
                                          },
                                          "module": {
                                            "type": "call",
                                            "fun": "paste0",
                                            "args": [
                                              {
                                                "type": "literal",
                                                "value": "health_check_"
                                              },
                                              {
                                                "type": "name",
                                                "value": "component"
                                              }
                                            ]
                                          },
                                          "context": {
                                            "type": "call",
                                            "fun": "list",
                                            "args": {
                                              "component": {
                                                "type": "name",
                                                "value": "component"
                                              },
                                              "metrics": {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "check"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "metrics"
                                                  }
                                                ]
                                              }
                                            }
                                          }
                                        }
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "log_file"
                          },
                          {
                            "type": "call",
                            "fun": "sprintf",
                            "args": [
                              {
                                "type": "literal",
                                "value": "log/health_critical_%s.log"
                              },
                              {
                                "type": "call",
                                "fun": "format",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "Sys.Date",
                                    "args": []
                                  },
                                  {
                                    "type": "literal",
                                    "value": "%Y%m%d"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "log_entry"
                          },
                          {
                            "type": "call",
                            "fun": "sprintf",
                            "args": [
                              {
                                "type": "literal",
                                "value": "[%s] CRITICAL: %s - Components: %s\n"
                              },
                              {
                                "type": "call",
                                "fun": "format",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "results"
                                      },
                                      {
                                        "type": "name",
                                        "value": "timestamp"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "literal",
                                    "value": "%Y-%m-%d %H:%M:%S"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "results"
                                  },
                                  {
                                    "type": "name",
                                    "value": "overall_status"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "paste",
                                "args": {
                                  "1": {
                                    "type": "name",
                                    "value": "critical_components"
                                  },
                                  "collapse": {
                                    "type": "literal",
                                    "value": ", "
                                  }
                                }
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "cat",
                        "args": {
                          "1": {
                            "type": "name",
                            "value": "log_entry"
                          },
                          "file": {
                            "type": "name",
                            "value": "log_file"
                          },
                          "append": {
                            "type": "literal",
                            "value": true
                          }
                        }
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "schedule_health_checks"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": "60"
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": ".health_config"
                      },
                      {
                        "type": "name",
                        "value": "check_interval_seconds"
                      }
                    ]
                  },
                  {
                    "type": "name",
                    "value": "interval_seconds"
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "run_scheduled_check"
                  },
                  {
                    "type": "call",
                    "fun": "function",
                    "args": [
                      {
                        "type": "NULL",
                        "value": []
                      },
                      {
                        "type": "call",
                        "fun": "{",
                        "args": [
                          {
                            "type": "call",
                            "fun": "tryCatch",
                            "args": {
                              "1": {
                                "type": "call",
                                "fun": "{",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "run_health_checks",
                                    "args": {
                                      "verbose": {
                                        "type": "literal",
                                        "value": false
                                      }
                                    }
                                  }
                                ]
                              },
                              "error": {
                                "type": "call",
                                "fun": "function",
                                "args": [
                                  {
                                    "type": "pairlist",
                                    "value": ""
                                  },
                                  {
                                    "type": "call",
                                    "fun": "{",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "warning",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "sprintf",
                                            "args": [
                                              {
                                                "type": "literal",
                                                "value": "Scheduled health check failed: %s"
                                              },
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "e"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "message"
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "type": "NULL",
                                    "value": []
                                  }
                                ]
                              }
                            }
                          },
                          {
                            "type": "call",
                            "fun": ["::", "later", "later"],
                            "args": {
                              "1": {
                                "type": "name",
                                "value": "run_scheduled_check"
                              },
                              "delay": {
                                "type": "name",
                                "value": "interval_seconds"
                              }
                            }
                          }
                        ]
                      },
                      {
                        "type": "NULL",
                        "value": []
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": ["::", "later", "later"],
                "args": {
                  "1": {
                    "type": "name",
                    "value": "run_scheduled_check"
                  },
                  "delay": {
                    "type": "name",
                    "value": "interval_seconds"
                  }
                }
              },
              {
                "type": "call",
                "fun": "message",
                "args": [
                  {
                    "type": "call",
                    "fun": "sprintf",
                    "args": [
                      {
                        "type": "literal",
                        "value": "Health checks scheduled every %d seconds"
                      },
                      {
                        "type": "name",
                        "value": "interval_seconds"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  }
]
