[
  {
    "type": "call",
    "fun": "if",
    "args": [
      {
        "type": "call",
        "fun": "!",
        "args": [
          {
            "type": "call",
            "fun": "requireNamespace",
            "args": {
              "1": {
                "type": "literal",
                "value": "R6"
              },
              "quietly": {
                "type": "literal",
                "value": true
              }
            }
          }
        ]
      },
      {
        "type": "call",
        "fun": "{",
        "args": [
          {
            "type": "call",
            "fun": "stop",
            "args": [
              {
                "type": "literal",
                "value": "Package 'R6' required. Install with: install.packages('R6')"
              }
            ]
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "if",
    "args": [
      {
        "type": "call",
        "fun": "!",
        "args": [
          {
            "type": "call",
            "fun": "requireNamespace",
            "args": {
              "1": {
                "type": "literal",
                "value": "digest"
              },
              "quietly": {
                "type": "literal",
                "value": true
              }
            }
          }
        ]
      },
      {
        "type": "call",
        "fun": "{",
        "args": [
          {
            "type": "call",
            "fun": "warning",
            "args": [
              {
                "type": "literal",
                "value": "Package 'digest' recommended for caching. Install with: install.packages('digest')"
              }
            ]
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "if",
    "args": [
      {
        "type": "call",
        "fun": "!",
        "args": [
          {
            "type": "call",
            "fun": "requireNamespace",
            "args": {
              "1": {
                "type": "literal",
                "value": "future"
              },
              "quietly": {
                "type": "literal",
                "value": true
              }
            }
          }
        ]
      },
      {
        "type": "call",
        "fun": "{",
        "args": [
          {
            "type": "call",
            "fun": "warning",
            "args": [
              {
                "type": "literal",
                "value": "Package 'future' recommended. Install with: install.packages('future')"
              }
            ]
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "JobQueue"
      },
      {
        "type": "call",
        "fun": ["::", "R6", "R6Class"],
        "args": {
          "1": {
            "type": "literal",
            "value": "JobQueue"
          },
          "private": {
            "type": "call",
            "fun": "list",
            "args": {
              ".queue": {
                "type": "call",
                "fun": "list",
                "args": []
              },
              ".running": {
                "type": "call",
                "fun": "list",
                "args": []
              },
              ".completed": {
                "type": "call",
                "fun": "list",
                "args": []
              },
              ".failed": {
                "type": "call",
                "fun": "list",
                "args": []
              },
              ".max_workers": {
                "type": "NULL",
                "value": []
              },
              ".cache_dir": {
                "type": "NULL",
                "value": []
              },
              ".result_cache": {
                "type": "call",
                "fun": "new.env",
                "args": {
                  "parent": {
                    "type": "call",
                    "fun": "emptyenv",
                    "args": []
                  }
                }
              },
              ".job_counter": {
                "type": "literal",
                "value": 0
              },
              ".worker_pool": {
                "type": "NULL",
                "value": []
              },
              ".monitoring": {
                "type": "literal",
                "value": false
              },
              ".stats": {
                "type": "call",
                "fun": "list",
                "args": []
              },
              "generate_job_id": {
                "type": "call",
                "fun": "function",
                "args": [
                  {
                    "type": "NULL",
                    "value": []
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "private"
                              },
                              {
                                "type": "name",
                                "value": ".job_counter"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "+",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "private"
                                  },
                                  {
                                    "type": "name",
                                    "value": ".job_counter"
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": 1
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "sprintf",
                        "args": [
                          {
                            "type": "literal",
                            "value": "job_%s_%06d"
                          },
                          {
                            "type": "call",
                            "fun": "format",
                            "args": [
                              {
                                "type": "call",
                                "fun": "Sys.time",
                                "args": []
                              },
                              {
                                "type": "literal",
                                "value": "%Y%m%d_%H%M%S"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "private"
                              },
                              {
                                "type": "name",
                                "value": ".job_counter"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "NULL",
                    "value": []
                  }
                ]
              },
              "calculate_job_hash": {
                "type": "call",
                "fun": "function",
                "args": [
                  {
                    "type": "pairlist",
                    "value": ""
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "requireNamespace",
                            "args": {
                              "1": {
                                "type": "literal",
                                "value": "digest"
                              },
                              "quietly": {
                                "type": "literal",
                                "value": true
                              }
                            }
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": ["::", "digest", "digest"],
                                "args": {
                                  "1": {
                                    "type": "name",
                                    "value": "job_spec"
                                  },
                                  "algo": {
                                    "type": "literal",
                                    "value": "xxhash64"
                                  }
                                }
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "paste",
                                "args": {
                                  "1": {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "job_spec"
                                      },
                                      {
                                        "type": "name",
                                        "value": "type"
                                      }
                                    ]
                                  },
                                  "2": {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "job_spec"
                                      },
                                      {
                                        "type": "name",
                                        "value": "priority"
                                      }
                                    ]
                                  },
                                  "collapse": {
                                    "type": "literal",
                                    "value": "_"
                                  }
                                }
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "NULL",
                    "value": []
                  }
                ]
              },
              "check_cache": {
                "type": "call",
                "fun": "function",
                "args": [
                  {
                    "type": "pairlist",
                    "value": ""
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "exists",
                            "args": {
                              "1": {
                                "type": "name",
                                "value": "job_hash"
                              },
                              "envir": {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "private"
                                  },
                                  {
                                    "type": "name",
                                    "value": ".result_cache"
                                  }
                                ]
                              }
                            }
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "return",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "get",
                                    "args": {
                                      "1": {
                                        "type": "name",
                                        "value": "job_hash"
                                      },
                                      "envir": {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "private"
                                          },
                                          {
                                            "type": "name",
                                            "value": ".result_cache"
                                          }
                                        ]
                                      }
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "!",
                            "args": [
                              {
                                "type": "call",
                                "fun": "is.null",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "private"
                                      },
                                      {
                                        "type": "name",
                                        "value": ".cache_dir"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "cache_file"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "file.path",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "private"
                                          },
                                          {
                                            "type": "name",
                                            "value": ".cache_dir"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "paste0",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "job_hash"
                                          },
                                          {
                                            "type": "literal",
                                            "value": ".rds"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "if",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "file.exists",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "cache_file"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "{",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "<-",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "file_age"
                                          },
                                          {
                                            "type": "call",
                                            "fun": "difftime",
                                            "args": {
                                              "1": {
                                                "type": "call",
                                                "fun": "Sys.time",
                                                "args": []
                                              },
                                              "2": {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "file.info",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "cache_file"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "mtime"
                                                  }
                                                ]
                                              },
                                              "units": {
                                                "type": "literal",
                                                "value": "hours"
                                              }
                                            }
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "<-",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "max_age"
                                          },
                                          {
                                            "type": "call",
                                            "fun": "getOption",
                                            "args": [
                                              {
                                                "type": "literal",
                                                "value": "tdmx_cache_max_age_hours"
                                              },
                                              {
                                                "type": "literal",
                                                "value": 24
                                              }
                                            ]
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "if",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "<",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "file_age"
                                              },
                                              {
                                                "type": "name",
                                                "value": "max_age"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "{",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "<-",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "result"
                                                  },
                                                  {
                                                    "type": "call",
                                                    "fun": "readRDS",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "cache_file"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "call",
                                                "fun": "assign",
                                                "args": {
                                                  "1": {
                                                    "type": "name",
                                                    "value": "job_hash"
                                                  },
                                                  "2": {
                                                    "type": "name",
                                                    "value": "result"
                                                  },
                                                  "envir": {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "private"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": ".result_cache"
                                                      }
                                                    ]
                                                  }
                                                }
                                              },
                                              {
                                                "type": "call",
                                                "fun": "return",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "result"
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "return",
                        "args": [
                          {
                            "type": "NULL",
                            "value": []
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "NULL",
                    "value": []
                  }
                ]
              },
              "save_to_cache": {
                "type": "call",
                "fun": "function",
                "args": [
                  {
                    "type": "pairlist",
                    "value": ["", ""]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "assign",
                        "args": {
                          "1": {
                            "type": "name",
                            "value": "job_hash"
                          },
                          "2": {
                            "type": "name",
                            "value": "result"
                          },
                          "envir": {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "private"
                              },
                              {
                                "type": "name",
                                "value": ".result_cache"
                              }
                            ]
                          }
                        }
                      },
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "!",
                            "args": [
                              {
                                "type": "call",
                                "fun": "is.null",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "private"
                                      },
                                      {
                                        "type": "name",
                                        "value": ".cache_dir"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "if",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "!",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "dir.exists",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "private"
                                              },
                                              {
                                                "type": "name",
                                                "value": ".cache_dir"
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "{",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "dir.create",
                                        "args": {
                                          "1": {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "private"
                                              },
                                              {
                                                "type": "name",
                                                "value": ".cache_dir"
                                              }
                                            ]
                                          },
                                          "recursive": {
                                            "type": "literal",
                                            "value": true
                                          }
                                        }
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "cache_file"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "file.path",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "private"
                                          },
                                          {
                                            "type": "name",
                                            "value": ".cache_dir"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "paste0",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "job_hash"
                                          },
                                          {
                                            "type": "literal",
                                            "value": ".rds"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "saveRDS",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "name",
                                    "value": "cache_file"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "NULL",
                    "value": []
                  }
                ]
              },
              "process_next": {
                "type": "call",
                "fun": "function",
                "args": [
                  {
                    "type": "NULL",
                    "value": []
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "==",
                            "args": [
                              {
                                "type": "call",
                                "fun": "length",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "private"
                                      },
                                      {
                                        "type": "name",
                                        "value": ".queue"
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": 0
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "return",
                                "args": [
                                  {
                                    "type": "NULL",
                                    "value": []
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "n_running"
                          },
                          {
                            "type": "call",
                            "fun": "length",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "private"
                                  },
                                  {
                                    "type": "name",
                                    "value": ".running"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": ">=",
                            "args": [
                              {
                                "type": "name",
                                "value": "n_running"
                              },
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "private"
                                  },
                                  {
                                    "type": "name",
                                    "value": ".max_workers"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "return",
                                "args": [
                                  {
                                    "type": "NULL",
                                    "value": []
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "priorities"
                          },
                          {
                            "type": "call",
                            "fun": "sapply",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "private"
                                  },
                                  {
                                    "type": "name",
                                    "value": ".queue"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "function",
                                "args": [
                                  {
                                    "type": "pairlist",
                                    "value": ""
                                  },
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "j"
                                      },
                                      {
                                        "type": "name",
                                        "value": "priority"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "NULL",
                                    "value": []
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "next_idx"
                          },
                          {
                            "type": "call",
                            "fun": "which.max",
                            "args": [
                              {
                                "type": "name",
                                "value": "priorities"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "job"
                          },
                          {
                            "type": "call",
                            "fun": "[[",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "private"
                                  },
                                  {
                                    "type": "name",
                                    "value": ".queue"
                                  }
                                ]
                              },
                              {
                                "type": "name",
                                "value": "next_idx"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "[[",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "private"
                                  },
                                  {
                                    "type": "name",
                                    "value": ".queue"
                                  }
                                ]
                              },
                              {
                                "type": "name",
                                "value": "next_idx"
                              }
                            ]
                          },
                          {
                            "type": "NULL",
                            "value": []
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "[[",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "private"
                                  },
                                  {
                                    "type": "name",
                                    "value": ".running"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "job"
                                  },
                                  {
                                    "type": "name",
                                    "value": "id"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "name",
                            "value": "job"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "job"
                              },
                              {
                                "type": "name",
                                "value": "status"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "running"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "job"
                              },
                              {
                                "type": "name",
                                "value": "start_time"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "Sys.time",
                            "args": []
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": ["$", "private", "execute_job"],
                        "args": [
                          {
                            "type": "name",
                            "value": "job"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "return",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "job"
                              },
                              {
                                "type": "name",
                                "value": "id"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "NULL",
                    "value": []
                  }
                ]
              },
              "execute_job": {
                "type": "call",
                "fun": "function",
                "args": [
                  {
                    "type": "pairlist",
                    "value": ""
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "job_hash"
                          },
                          {
                            "type": "call",
                            "fun": ["$", "private", "calculate_job_hash"],
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "job"
                                  },
                                  {
                                    "type": "name",
                                    "value": "spec"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "cached_result"
                          },
                          {
                            "type": "call",
                            "fun": ["$", "private", "check_cache"],
                            "args": [
                              {
                                "type": "name",
                                "value": "job_hash"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "!",
                            "args": [
                              {
                                "type": "call",
                                "fun": "is.null",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "cached_result"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "job"
                                      },
                                      {
                                        "type": "name",
                                        "value": "result"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "name",
                                    "value": "cached_result"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "job"
                                      },
                                      {
                                        "type": "name",
                                        "value": "status"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "literal",
                                    "value": "completed"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "job"
                                      },
                                      {
                                        "type": "name",
                                        "value": "end_time"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "Sys.time",
                                    "args": []
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "job"
                                      },
                                      {
                                        "type": "name",
                                        "value": "from_cache"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "literal",
                                    "value": true
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "[[",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "private"
                                          },
                                          {
                                            "type": "name",
                                            "value": ".running"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "job"
                                          },
                                          {
                                            "type": "name",
                                            "value": "id"
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "type": "NULL",
                                    "value": []
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "[[",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "private"
                                          },
                                          {
                                            "type": "name",
                                            "value": ".completed"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "job"
                                          },
                                          {
                                            "type": "name",
                                            "value": "id"
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "type": "name",
                                    "value": "job"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "if",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "!",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "is.null",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "job"
                                              },
                                              {
                                                "type": "name",
                                                "value": "callback"
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "{",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": ["$", "job", "callback"],
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "job"
                                              },
                                              {
                                                "type": "name",
                                                "value": "result"
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "return",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "invisible",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "job"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "requireNamespace",
                            "args": {
                              "1": {
                                "type": "literal",
                                "value": "future"
                              },
                              "quietly": {
                                "type": "literal",
                                "value": true
                              }
                            }
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "job"
                                      },
                                      {
                                        "type": "name",
                                        "value": "future"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": ["::", "future", "future"],
                                    "args": {
                                      "1": {
                                        "type": "call",
                                        "fun": "{",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "<-",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "result"
                                              },
                                              {
                                                "type": "call",
                                                "fun": "switch",
                                                "args": {
                                                  "1": {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "job"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": "type"
                                                      }
                                                    ]
                                                  },
                                                  "stan_fit": {
                                                    "type": "call",
                                                    "fun": ["$", "private", "execute_stan_fit"],
                                                    "args": [
                                                      {
                                                        "type": "call",
                                                        "fun": "$",
                                                        "args": [
                                                          {
                                                            "type": "name",
                                                            "value": "job"
                                                          },
                                                          {
                                                            "type": "name",
                                                            "value": "spec"
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  },
                                                  "pta_calculation": {
                                                    "type": "call",
                                                    "fun": ["$", "private", "execute_pta_calc"],
                                                    "args": [
                                                      {
                                                        "type": "call",
                                                        "fun": "$",
                                                        "args": [
                                                          {
                                                            "type": "name",
                                                            "value": "job"
                                                          },
                                                          {
                                                            "type": "name",
                                                            "value": "spec"
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  },
                                                  "optimization": {
                                                    "type": "call",
                                                    "fun": ["$", "private", "execute_optimization"],
                                                    "args": [
                                                      {
                                                        "type": "call",
                                                        "fun": "$",
                                                        "args": [
                                                          {
                                                            "type": "name",
                                                            "value": "job"
                                                          },
                                                          {
                                                            "type": "name",
                                                            "value": "spec"
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  },
                                                  "batch_processing": {
                                                    "type": "call",
                                                    "fun": ["$", "private", "execute_batch"],
                                                    "args": [
                                                      {
                                                        "type": "call",
                                                        "fun": "$",
                                                        "args": [
                                                          {
                                                            "type": "name",
                                                            "value": "job"
                                                          },
                                                          {
                                                            "type": "name",
                                                            "value": "spec"
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  },
                                                  "6": {
                                                    "type": "call",
                                                    "fun": "stop",
                                                    "args": [
                                                      {
                                                        "type": "literal",
                                                        "value": "Unknown job type: "
                                                      },
                                                      {
                                                        "type": "call",
                                                        "fun": "$",
                                                        "args": [
                                                          {
                                                            "type": "name",
                                                            "value": "job"
                                                          },
                                                          {
                                                            "type": "name",
                                                            "value": "type"
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  }
                                                }
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "return",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "result"
                                              }
                                            ]
                                          }
                                        ]
                                      },
                                      "lazy": {
                                        "type": "literal",
                                        "value": false
                                      }
                                    }
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": ["::", "promises", "then"],
                                "args": {
                                  "1": {
                                    "type": "call",
                                    "fun": ["::", "promises", "future_promise"],
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "job"
                                          },
                                          {
                                            "type": "name",
                                            "value": "future"
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  "onFulfilled": {
                                    "type": "call",
                                    "fun": "function",
                                    "args": [
                                      {
                                        "type": "pairlist",
                                        "value": ""
                                      },
                                      {
                                        "type": "call",
                                        "fun": "{",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "<-",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "job"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "result"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "name",
                                                "value": "result"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "<-",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "job"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "status"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "literal",
                                                "value": "completed"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "<-",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "job"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "end_time"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "call",
                                                "fun": "Sys.time",
                                                "args": []
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "<-",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "job"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "from_cache"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "literal",
                                                "value": false
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": ["$", "private", "save_to_cache"],
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "job_hash"
                                              },
                                              {
                                                "type": "name",
                                                "value": "result"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "<-",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "[[",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "private"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": ".running"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "job"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": "id"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "NULL",
                                                "value": []
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "<-",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "[[",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "private"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": ".completed"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "job"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": "id"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "name",
                                                "value": "job"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "if",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "!",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "is.null",
                                                    "args": [
                                                      {
                                                        "type": "call",
                                                        "fun": "$",
                                                        "args": [
                                                          {
                                                            "type": "name",
                                                            "value": "job"
                                                          },
                                                          {
                                                            "type": "name",
                                                            "value": "callback"
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "call",
                                                "fun": "{",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": ["$", "job", "callback"],
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "result"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": ["$", "private", "process_next"],
                                            "args": []
                                          }
                                        ]
                                      },
                                      {
                                        "type": "NULL",
                                        "value": []
                                      }
                                    ]
                                  },
                                  "onRejected": {
                                    "type": "call",
                                    "fun": "function",
                                    "args": [
                                      {
                                        "type": "pairlist",
                                        "value": ""
                                      },
                                      {
                                        "type": "call",
                                        "fun": "{",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "<-",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "job"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "error"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "name",
                                                "value": "error"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "<-",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "job"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "status"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "literal",
                                                "value": "failed"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "<-",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "job"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "end_time"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "call",
                                                "fun": "Sys.time",
                                                "args": []
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "<-",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "[[",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "private"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": ".running"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "job"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": "id"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "NULL",
                                                "value": []
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "<-",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "[[",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "private"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": ".failed"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "job"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": "id"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "name",
                                                "value": "job"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "if",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "!",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "is.null",
                                                    "args": [
                                                      {
                                                        "type": "call",
                                                        "fun": "$",
                                                        "args": [
                                                          {
                                                            "type": "name",
                                                            "value": "job"
                                                          },
                                                          {
                                                            "type": "name",
                                                            "value": "error_callback"
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "call",
                                                "fun": "{",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": ["$", "job", "error_callback"],
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "error"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": ["$", "private", "process_next"],
                                            "args": []
                                          }
                                        ]
                                      },
                                      {
                                        "type": "NULL",
                                        "value": []
                                      }
                                    ]
                                  }
                                }
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "tryCatch",
                                "args": {
                                  "1": {
                                    "type": "call",
                                    "fun": "{",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "<-",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "result"
                                          },
                                          {
                                            "type": "call",
                                            "fun": "switch",
                                            "args": {
                                              "1": {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "job"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "type"
                                                  }
                                                ]
                                              },
                                              "stan_fit": {
                                                "type": "call",
                                                "fun": ["$", "private", "execute_stan_fit"],
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "job"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": "spec"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              },
                                              "pta_calculation": {
                                                "type": "call",
                                                "fun": ["$", "private", "execute_pta_calc"],
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "job"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": "spec"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              },
                                              "optimization": {
                                                "type": "call",
                                                "fun": ["$", "private", "execute_optimization"],
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "job"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": "spec"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              },
                                              "batch_processing": {
                                                "type": "call",
                                                "fun": ["$", "private", "execute_batch"],
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "job"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": "spec"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              },
                                              "6": {
                                                "type": "call",
                                                "fun": "stop",
                                                "args": [
                                                  {
                                                    "type": "literal",
                                                    "value": "Unknown job type: "
                                                  },
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "job"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": "type"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            }
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "<-",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "job"
                                              },
                                              {
                                                "type": "name",
                                                "value": "result"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "name",
                                            "value": "result"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "<-",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "job"
                                              },
                                              {
                                                "type": "name",
                                                "value": "status"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "literal",
                                            "value": "completed"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "<-",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "job"
                                              },
                                              {
                                                "type": "name",
                                                "value": "end_time"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "Sys.time",
                                            "args": []
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "<-",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "job"
                                              },
                                              {
                                                "type": "name",
                                                "value": "from_cache"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "literal",
                                            "value": false
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": ["$", "private", "save_to_cache"],
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "job_hash"
                                          },
                                          {
                                            "type": "name",
                                            "value": "result"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "<-",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "[[",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "private"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": ".running"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "job"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "id"
                                                  }
                                                ]
                                              }
                                            ]
                                          },
                                          {
                                            "type": "NULL",
                                            "value": []
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "<-",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "[[",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "private"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": ".completed"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "job"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "id"
                                                  }
                                                ]
                                              }
                                            ]
                                          },
                                          {
                                            "type": "name",
                                            "value": "job"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "if",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "!",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "is.null",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "job"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": "callback"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "{",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": ["$", "job", "callback"],
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "result"
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  "error": {
                                    "type": "call",
                                    "fun": "function",
                                    "args": [
                                      {
                                        "type": "pairlist",
                                        "value": ""
                                      },
                                      {
                                        "type": "call",
                                        "fun": "{",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "<-",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "job"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "error"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "name",
                                                "value": "e"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "<-",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "job"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "status"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "literal",
                                                "value": "failed"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "<-",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "job"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "end_time"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "call",
                                                "fun": "Sys.time",
                                                "args": []
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "<-",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "[[",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "private"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": ".running"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "job"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": "id"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "NULL",
                                                "value": []
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "<-",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "[[",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "private"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": ".failed"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "job"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": "id"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "name",
                                                "value": "job"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "if",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "!",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "is.null",
                                                    "args": [
                                                      {
                                                        "type": "call",
                                                        "fun": "$",
                                                        "args": [
                                                          {
                                                            "type": "name",
                                                            "value": "job"
                                                          },
                                                          {
                                                            "type": "name",
                                                            "value": "error_callback"
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "call",
                                                "fun": "{",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": ["$", "job", "error_callback"],
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "e"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      },
                                      {
                                        "type": "NULL",
                                        "value": []
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "type": "call",
                                "fun": ["$", "private", "process_next"],
                                "args": []
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "NULL",
                    "value": []
                  }
                ]
              },
              "execute_stan_fit": {
                "type": "call",
                "fun": "function",
                "args": [
                  {
                    "type": "pairlist",
                    "value": ""
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "file.exists",
                            "args": [
                              {
                                "type": "literal",
                                "value": "R/backend_bayes.R"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "source",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": "backend_bayes.R"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "result"
                          },
                          {
                            "type": "call",
                            "fun": "do.call",
                            "args": [
                              {
                                "type": "name",
                                "value": "run_fit_stan_hmc"
                              },
                              {
                                "type": "name",
                                "value": "spec"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "return",
                        "args": [
                          {
                            "type": "name",
                            "value": "result"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "NULL",
                    "value": []
                  }
                ]
              },
              "execute_pta_calc": {
                "type": "call",
                "fun": "function",
                "args": [
                  {
                    "type": "pairlist",
                    "value": ""
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "file.exists",
                            "args": [
                              {
                                "type": "literal",
                                "value": "R/pta_cfr.R"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "source",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": "pta_cfr.R"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "exists",
                            "args": [
                              {
                                "type": "literal",
                                "value": "pta_parallel"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "pta_parallel",
                                    "args": {
                                      "draws": {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "spec"
                                          },
                                          {
                                            "type": "name",
                                            "value": "draws"
                                          }
                                        ]
                                      },
                                      "regimen": {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "spec"
                                          },
                                          {
                                            "type": "name",
                                            "value": "regimen"
                                          }
                                        ]
                                      },
                                      "n_cores": {
                                        "type": "call",
                                        "fun": "%||%",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "spec"
                                              },
                                              {
                                                "type": "name",
                                                "value": "n_cores"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "get_optimal_workers",
                                            "args": []
                                          }
                                        ]
                                      }
                                    }
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "pta_for_regimen",
                                    "args": {
                                      "draws": {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "spec"
                                          },
                                          {
                                            "type": "name",
                                            "value": "draws"
                                          }
                                        ]
                                      },
                                      "regimen": {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "spec"
                                          },
                                          {
                                            "type": "name",
                                            "value": "regimen"
                                          }
                                        ]
                                      },
                                      "model_type": {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "spec"
                                          },
                                          {
                                            "type": "name",
                                            "value": "model_type"
                                          }
                                        ]
                                      },
                                      "target_def": {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "spec"
                                          },
                                          {
                                            "type": "name",
                                            "value": "target_def"
                                          }
                                        ]
                                      },
                                      "MIC": {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "spec"
                                          },
                                          {
                                            "type": "name",
                                            "value": "MIC"
                                          }
                                        ]
                                      }
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "return",
                        "args": [
                          {
                            "type": "name",
                            "value": "result"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "NULL",
                    "value": []
                  }
                ]
              },
              "execute_optimization": {
                "type": "call",
                "fun": "function",
                "args": [
                  {
                    "type": "pairlist",
                    "value": ""
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "message",
                        "args": [
                          {
                            "type": "literal",
                            "value": "Executing optimization job..."
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "Sys.sleep",
                        "args": [
                          {
                            "type": "literal",
                            "value": 2
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "return",
                        "args": [
                          {
                            "type": "call",
                            "fun": "list",
                            "args": {
                              "optimal_dose": {
                                "type": "call",
                                "fun": "*",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "spec"
                                      },
                                      {
                                        "type": "name",
                                        "value": "dose"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "literal",
                                    "value": 1.1
                                  }
                                ]
                              }
                            }
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "NULL",
                    "value": []
                  }
                ]
              },
              "execute_batch": {
                "type": "call",
                "fun": "function",
                "args": [
                  {
                    "type": "pairlist",
                    "value": ""
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "exists",
                            "args": [
                              {
                                "type": "literal",
                                "value": "parallel_process_chunked"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "parallel_process_chunked",
                                    "args": {
                                      "data": {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "spec"
                                          },
                                          {
                                            "type": "name",
                                            "value": "data"
                                          }
                                        ]
                                      },
                                      "fun": {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "spec"
                                          },
                                          {
                                            "type": "name",
                                            "value": "fun"
                                          }
                                        ]
                                      },
                                      "n_cores": {
                                        "type": "call",
                                        "fun": "%||%",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "spec"
                                              },
                                              {
                                                "type": "name",
                                                "value": "n_cores"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "get_optimal_workers",
                                            "args": []
                                          }
                                        ]
                                      }
                                    }
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "result"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "lapply",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "spec"
                                          },
                                          {
                                            "type": "name",
                                            "value": "data"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "spec"
                                          },
                                          {
                                            "type": "name",
                                            "value": "fun"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "return",
                        "args": [
                          {
                            "type": "name",
                            "value": "result"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "NULL",
                    "value": []
                  }
                ]
              },
              "monitor_stats": {
                "type": "call",
                "fun": "function",
                "args": [
                  {
                    "type": "NULL",
                    "value": []
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "stats"
                          },
                          {
                            "type": "call",
                            "fun": "list",
                            "args": {
                              "timestamp": {
                                "type": "call",
                                "fun": "Sys.time",
                                "args": []
                              },
                              "queued": {
                                "type": "call",
                                "fun": "length",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "private"
                                      },
                                      {
                                        "type": "name",
                                        "value": ".queue"
                                      }
                                    ]
                                  }
                                ]
                              },
                              "running": {
                                "type": "call",
                                "fun": "length",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "private"
                                      },
                                      {
                                        "type": "name",
                                        "value": ".running"
                                      }
                                    ]
                                  }
                                ]
                              },
                              "completed": {
                                "type": "call",
                                "fun": "length",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "private"
                                      },
                                      {
                                        "type": "name",
                                        "value": ".completed"
                                      }
                                    ]
                                  }
                                ]
                              },
                              "failed": {
                                "type": "call",
                                "fun": "length",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "private"
                                      },
                                      {
                                        "type": "name",
                                        "value": ".failed"
                                      }
                                    ]
                                  }
                                ]
                              },
                              "cache_hits": {
                                "type": "call",
                                "fun": "sum",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "sapply",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "private"
                                          },
                                          {
                                            "type": "name",
                                            "value": ".completed"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "function",
                                        "args": [
                                          {
                                            "type": "pairlist",
                                            "value": ""
                                          },
                                          {
                                            "type": "call",
                                            "fun": "%||%",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "j"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "from_cache"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "literal",
                                                "value": false
                                              }
                                            ]
                                          },
                                          {
                                            "type": "NULL",
                                            "value": []
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              "avg_wait_time": {
                                "type": "call",
                                "fun": "mean",
                                "args": {
                                  "1": {
                                    "type": "call",
                                    "fun": "sapply",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "private"
                                          },
                                          {
                                            "type": "name",
                                            "value": ".completed"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "function",
                                        "args": [
                                          {
                                            "type": "pairlist",
                                            "value": ""
                                          },
                                          {
                                            "type": "call",
                                            "fun": "{",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "if",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "&&",
                                                    "args": [
                                                      {
                                                        "type": "call",
                                                        "fun": "!",
                                                        "args": [
                                                          {
                                                            "type": "call",
                                                            "fun": "is.null",
                                                            "args": [
                                                              {
                                                                "type": "call",
                                                                "fun": "$",
                                                                "args": [
                                                                  {
                                                                    "type": "name",
                                                                    "value": "j"
                                                                  },
                                                                  {
                                                                    "type": "name",
                                                                    "value": "start_time"
                                                                  }
                                                                ]
                                                              }
                                                            ]
                                                          }
                                                        ]
                                                      },
                                                      {
                                                        "type": "call",
                                                        "fun": "!",
                                                        "args": [
                                                          {
                                                            "type": "call",
                                                            "fun": "is.null",
                                                            "args": [
                                                              {
                                                                "type": "call",
                                                                "fun": "$",
                                                                "args": [
                                                                  {
                                                                    "type": "name",
                                                                    "value": "j"
                                                                  },
                                                                  {
                                                                    "type": "name",
                                                                    "value": "submit_time"
                                                                  }
                                                                ]
                                                              }
                                                            ]
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "type": "call",
                                                    "fun": "{",
                                                    "args": [
                                                      {
                                                        "type": "call",
                                                        "fun": "as.numeric",
                                                        "args": [
                                                          {
                                                            "type": "call",
                                                            "fun": "difftime",
                                                            "args": {
                                                              "1": {
                                                                "type": "call",
                                                                "fun": "$",
                                                                "args": [
                                                                  {
                                                                    "type": "name",
                                                                    "value": "j"
                                                                  },
                                                                  {
                                                                    "type": "name",
                                                                    "value": "start_time"
                                                                  }
                                                                ]
                                                              },
                                                              "2": {
                                                                "type": "call",
                                                                "fun": "$",
                                                                "args": [
                                                                  {
                                                                    "type": "name",
                                                                    "value": "j"
                                                                  },
                                                                  {
                                                                    "type": "name",
                                                                    "value": "submit_time"
                                                                  }
                                                                ]
                                                              },
                                                              "units": {
                                                                "type": "literal",
                                                                "value": "secs"
                                                              }
                                                            }
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "type": "call",
                                                    "fun": "{",
                                                    "args": [
                                                      {
                                                        "type": "literal",
                                                        "value": null
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            ]
                                          },
                                          {
                                            "type": "NULL",
                                            "value": []
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  "na.rm": {
                                    "type": "literal",
                                    "value": true
                                  }
                                }
                              },
                              "avg_run_time": {
                                "type": "call",
                                "fun": "mean",
                                "args": {
                                  "1": {
                                    "type": "call",
                                    "fun": "sapply",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "private"
                                          },
                                          {
                                            "type": "name",
                                            "value": ".completed"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "function",
                                        "args": [
                                          {
                                            "type": "pairlist",
                                            "value": ""
                                          },
                                          {
                                            "type": "call",
                                            "fun": "{",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "if",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "&&",
                                                    "args": [
                                                      {
                                                        "type": "call",
                                                        "fun": "!",
                                                        "args": [
                                                          {
                                                            "type": "call",
                                                            "fun": "is.null",
                                                            "args": [
                                                              {
                                                                "type": "call",
                                                                "fun": "$",
                                                                "args": [
                                                                  {
                                                                    "type": "name",
                                                                    "value": "j"
                                                                  },
                                                                  {
                                                                    "type": "name",
                                                                    "value": "end_time"
                                                                  }
                                                                ]
                                                              }
                                                            ]
                                                          }
                                                        ]
                                                      },
                                                      {
                                                        "type": "call",
                                                        "fun": "!",
                                                        "args": [
                                                          {
                                                            "type": "call",
                                                            "fun": "is.null",
                                                            "args": [
                                                              {
                                                                "type": "call",
                                                                "fun": "$",
                                                                "args": [
                                                                  {
                                                                    "type": "name",
                                                                    "value": "j"
                                                                  },
                                                                  {
                                                                    "type": "name",
                                                                    "value": "start_time"
                                                                  }
                                                                ]
                                                              }
                                                            ]
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "type": "call",
                                                    "fun": "{",
                                                    "args": [
                                                      {
                                                        "type": "call",
                                                        "fun": "as.numeric",
                                                        "args": [
                                                          {
                                                            "type": "call",
                                                            "fun": "difftime",
                                                            "args": {
                                                              "1": {
                                                                "type": "call",
                                                                "fun": "$",
                                                                "args": [
                                                                  {
                                                                    "type": "name",
                                                                    "value": "j"
                                                                  },
                                                                  {
                                                                    "type": "name",
                                                                    "value": "end_time"
                                                                  }
                                                                ]
                                                              },
                                                              "2": {
                                                                "type": "call",
                                                                "fun": "$",
                                                                "args": [
                                                                  {
                                                                    "type": "name",
                                                                    "value": "j"
                                                                  },
                                                                  {
                                                                    "type": "name",
                                                                    "value": "start_time"
                                                                  }
                                                                ]
                                                              },
                                                              "units": {
                                                                "type": "literal",
                                                                "value": "secs"
                                                              }
                                                            }
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "type": "call",
                                                    "fun": "{",
                                                    "args": [
                                                      {
                                                        "type": "literal",
                                                        "value": null
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            ]
                                          },
                                          {
                                            "type": "NULL",
                                            "value": []
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  "na.rm": {
                                    "type": "literal",
                                    "value": true
                                  }
                                }
                              }
                            }
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "[[",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "private"
                                  },
                                  {
                                    "type": "name",
                                    "value": ".stats"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "+",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "length",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "private"
                                          },
                                          {
                                            "type": "name",
                                            "value": ".stats"
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "type": "literal",
                                    "value": 1
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "name",
                            "value": "stats"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "return",
                        "args": [
                          {
                            "type": "name",
                            "value": "stats"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "NULL",
                    "value": []
                  }
                ]
              }
            }
          },
          "public": {
            "type": "call",
            "fun": "list",
            "args": {
              "initialize": {
                "type": "call",
                "fun": "function",
                "args": [
                  {
                    "type": "pairlist",
                    "value": ["NULL", "NULL"]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "is.null",
                            "args": [
                              {
                                "type": "name",
                                "value": "max_workers"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "max_workers"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "get_optimal_workers",
                                    "args": {
                                      "task_type": {
                                        "type": "literal",
                                        "value": "memory"
                                      }
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "private"
                              },
                              {
                                "type": "name",
                                "value": ".max_workers"
                              }
                            ]
                          },
                          {
                            "type": "name",
                            "value": "max_workers"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "private"
                              },
                              {
                                "type": "name",
                                "value": ".cache_dir"
                              }
                            ]
                          },
                          {
                            "type": "name",
                            "value": "cache_dir"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "&&",
                            "args": [
                              {
                                "type": "call",
                                "fun": "!",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "is.null",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "cache_dir"
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "!",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "dir.exists",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "cache_dir"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "dir.create",
                                "args": {
                                  "1": {
                                    "type": "name",
                                    "value": "cache_dir"
                                  },
                                  "recursive": {
                                    "type": "literal",
                                    "value": true
                                  }
                                }
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "message",
                        "args": [
                          {
                            "type": "call",
                            "fun": "sprintf",
                            "args": [
                              {
                                "type": "literal",
                                "value": "Job queue initialized with %d workers"
                              },
                              {
                                "type": "name",
                                "value": "max_workers"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "NULL",
                    "value": []
                  }
                ]
              },
              "submit": {
                "type": "call",
                "fun": "function",
                "args": [
                  {
                    "type": "pairlist",
                    "value": ["", "", "5", "NULL", "NULL"]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "job_id"
                          },
                          {
                            "type": "call",
                            "fun": ["$", "private", "generate_job_id"],
                            "args": []
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "job"
                          },
                          {
                            "type": "call",
                            "fun": "list",
                            "args": {
                              "id": {
                                "type": "name",
                                "value": "job_id"
                              },
                              "type": {
                                "type": "name",
                                "value": "type"
                              },
                              "spec": {
                                "type": "name",
                                "value": "spec"
                              },
                              "priority": {
                                "type": "name",
                                "value": "priority"
                              },
                              "status": {
                                "type": "literal",
                                "value": "queued"
                              },
                              "submit_time": {
                                "type": "call",
                                "fun": "Sys.time",
                                "args": []
                              },
                              "start_time": {
                                "type": "NULL",
                                "value": []
                              },
                              "end_time": {
                                "type": "NULL",
                                "value": []
                              },
                              "result": {
                                "type": "NULL",
                                "value": []
                              },
                              "error": {
                                "type": "NULL",
                                "value": []
                              },
                              "callback": {
                                "type": "name",
                                "value": "callback"
                              },
                              "error_callback": {
                                "type": "name",
                                "value": "error_callback"
                              },
                              "from_cache": {
                                "type": "literal",
                                "value": false
                              }
                            }
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "[[",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "private"
                                  },
                                  {
                                    "type": "name",
                                    "value": ".queue"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "+",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "length",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "private"
                                          },
                                          {
                                            "type": "name",
                                            "value": ".queue"
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "type": "literal",
                                    "value": 1
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "name",
                            "value": "job"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": ["$", "private", "process_next"],
                        "args": []
                      },
                      {
                        "type": "call",
                        "fun": "return",
                        "args": [
                          {
                            "type": "name",
                            "value": "job_id"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "NULL",
                    "value": []
                  }
                ]
              },
              "submit_batch": {
                "type": "call",
                "fun": "function",
                "args": [
                  {
                    "type": "pairlist",
                    "value": ""
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "job_ids"
                          },
                          {
                            "type": "call",
                            "fun": "character",
                            "args": [
                              {
                                "type": "call",
                                "fun": "length",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "jobs"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "for",
                        "args": [
                          {
                            "type": "name",
                            "value": "i"
                          },
                          {
                            "type": "call",
                            "fun": "seq_along",
                            "args": [
                              {
                                "type": "name",
                                "value": "jobs"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "[",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "job_ids"
                                      },
                                      {
                                        "type": "name",
                                        "value": "i"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": ["$", "self", "submit"],
                                    "args": {
                                      "type": {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "[[",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "jobs"
                                              },
                                              {
                                                "type": "name",
                                                "value": "i"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "name",
                                            "value": "type"
                                          }
                                        ]
                                      },
                                      "spec": {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "[[",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "jobs"
                                              },
                                              {
                                                "type": "name",
                                                "value": "i"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "name",
                                            "value": "spec"
                                          }
                                        ]
                                      },
                                      "priority": {
                                        "type": "call",
                                        "fun": "%||%",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "[[",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "jobs"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "i"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "name",
                                                "value": "priority"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "literal",
                                            "value": 5
                                          }
                                        ]
                                      },
                                      "callback": {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "[[",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "jobs"
                                              },
                                              {
                                                "type": "name",
                                                "value": "i"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "name",
                                            "value": "callback"
                                          }
                                        ]
                                      },
                                      "error_callback": {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "[[",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "jobs"
                                              },
                                              {
                                                "type": "name",
                                                "value": "i"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "name",
                                            "value": "error_callback"
                                          }
                                        ]
                                      }
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "return",
                        "args": [
                          {
                            "type": "name",
                            "value": "job_ids"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "NULL",
                    "value": []
                  }
                ]
              },
              "status": {
                "type": "call",
                "fun": "function",
                "args": [
                  {
                    "type": "pairlist",
                    "value": ""
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "%in%",
                            "args": [
                              {
                                "type": "name",
                                "value": "job_id"
                              },
                              {
                                "type": "call",
                                "fun": "names",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "private"
                                      },
                                      {
                                        "type": "name",
                                        "value": ".running"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "return",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "[[",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "private"
                                              },
                                              {
                                                "type": "name",
                                                "value": ".running"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "name",
                                            "value": "job_id"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "name",
                                        "value": "status"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "%in%",
                            "args": [
                              {
                                "type": "name",
                                "value": "job_id"
                              },
                              {
                                "type": "call",
                                "fun": "names",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "private"
                                      },
                                      {
                                        "type": "name",
                                        "value": ".completed"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "return",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": "completed"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "%in%",
                            "args": [
                              {
                                "type": "name",
                                "value": "job_id"
                              },
                              {
                                "type": "call",
                                "fun": "names",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "private"
                                      },
                                      {
                                        "type": "name",
                                        "value": ".failed"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "return",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": "failed"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "for",
                        "args": [
                          {
                            "type": "name",
                            "value": "job"
                          },
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "private"
                              },
                              {
                                "type": "name",
                                "value": ".queue"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "if",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "==",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "job"
                                          },
                                          {
                                            "type": "name",
                                            "value": "id"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "name",
                                        "value": "job_id"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "{",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "return",
                                        "args": [
                                          {
                                            "type": "literal",
                                            "value": "queued"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "return",
                        "args": [
                          {
                            "type": "literal",
                            "value": "not_found"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "NULL",
                    "value": []
                  }
                ]
              },
              "result": {
                "type": "call",
                "fun": "function",
                "args": [
                  {
                    "type": "pairlist",
                    "value": ["", "FALSE", "60"]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "name",
                            "value": "wait"
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "start_time"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "Sys.time",
                                    "args": []
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "while",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "<",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "difftime",
                                        "args": {
                                          "1": {
                                            "type": "call",
                                            "fun": "Sys.time",
                                            "args": []
                                          },
                                          "2": {
                                            "type": "name",
                                            "value": "start_time"
                                          },
                                          "units": {
                                            "type": "literal",
                                            "value": "secs"
                                          }
                                        }
                                      },
                                      {
                                        "type": "name",
                                        "value": "timeout"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "{",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "<-",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "status"
                                          },
                                          {
                                            "type": "call",
                                            "fun": ["$", "self", "status"],
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "job_id"
                                              }
                                            ]
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "if",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "==",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "status"
                                              },
                                              {
                                                "type": "literal",
                                                "value": "completed"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "{",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "return",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "call",
                                                        "fun": "[[",
                                                        "args": [
                                                          {
                                                            "type": "call",
                                                            "fun": "$",
                                                            "args": [
                                                              {
                                                                "type": "name",
                                                                "value": "private"
                                                              },
                                                              {
                                                                "type": "name",
                                                                "value": ".completed"
                                                              }
                                                            ]
                                                          },
                                                          {
                                                            "type": "name",
                                                            "value": "job_id"
                                                          }
                                                        ]
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": "result"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "if",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "==",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "status"
                                                  },
                                                  {
                                                    "type": "literal",
                                                    "value": "failed"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "call",
                                                "fun": "{",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "stop",
                                                    "args": [
                                                      {
                                                        "type": "literal",
                                                        "value": "Job failed: "
                                                      },
                                                      {
                                                        "type": "call",
                                                        "fun": "$",
                                                        "args": [
                                                          {
                                                            "type": "call",
                                                            "fun": "$",
                                                            "args": [
                                                              {
                                                                "type": "call",
                                                                "fun": "[[",
                                                                "args": [
                                                                  {
                                                                    "type": "call",
                                                                    "fun": "$",
                                                                    "args": [
                                                                      {
                                                                        "type": "name",
                                                                        "value": "private"
                                                                      },
                                                                      {
                                                                        "type": "name",
                                                                        "value": ".failed"
                                                                      }
                                                                    ]
                                                                  },
                                                                  {
                                                                    "type": "name",
                                                                    "value": "job_id"
                                                                  }
                                                                ]
                                                              },
                                                              {
                                                                "type": "name",
                                                                "value": "error"
                                                              }
                                                            ]
                                                          },
                                                          {
                                                            "type": "name",
                                                            "value": "message"
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "call",
                                                "fun": "if",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "==",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "status"
                                                      },
                                                      {
                                                        "type": "literal",
                                                        "value": "not_found"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "type": "call",
                                                    "fun": "{",
                                                    "args": [
                                                      {
                                                        "type": "call",
                                                        "fun": "stop",
                                                        "args": [
                                                          {
                                                            "type": "literal",
                                                            "value": "Job not found: "
                                                          },
                                                          {
                                                            "type": "name",
                                                            "value": "job_id"
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "Sys.sleep",
                                        "args": [
                                          {
                                            "type": "literal",
                                            "value": 0.5
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "stop",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": "Timeout waiting for job: "
                                  },
                                  {
                                    "type": "name",
                                    "value": "job_id"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "if",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "%in%",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "job_id"
                                      },
                                      {
                                        "type": "call",
                                        "fun": "names",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "private"
                                              },
                                              {
                                                "type": "name",
                                                "value": ".completed"
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "{",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "return",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "[[",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "private"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": ".completed"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "job_id"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "name",
                                                "value": "result"
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "{",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "return",
                                        "args": [
                                          {
                                            "type": "NULL",
                                            "value": []
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "NULL",
                    "value": []
                  }
                ]
              },
              "cancel": {
                "type": "call",
                "fun": "function",
                "args": [
                  {
                    "type": "pairlist",
                    "value": ""
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "for",
                        "args": [
                          {
                            "type": "name",
                            "value": "i"
                          },
                          {
                            "type": "call",
                            "fun": "seq_along",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "private"
                                  },
                                  {
                                    "type": "name",
                                    "value": ".queue"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "if",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "==",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "[[",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "private"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": ".queue"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "name",
                                                "value": "i"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "name",
                                            "value": "id"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "name",
                                        "value": "job_id"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "{",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "<-",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "[[",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "private"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": ".queue"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "name",
                                                "value": "i"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "NULL",
                                            "value": []
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "return",
                                        "args": [
                                          {
                                            "type": "literal",
                                            "value": true
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "%in%",
                            "args": [
                              {
                                "type": "name",
                                "value": "job_id"
                              },
                              {
                                "type": "call",
                                "fun": "names",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "private"
                                      },
                                      {
                                        "type": "name",
                                        "value": ".running"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "job"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "[[",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "private"
                                          },
                                          {
                                            "type": "name",
                                            "value": ".running"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "name",
                                        "value": "job_id"
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "if",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "&&",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "!",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "is.null",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "job"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "future"
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "requireNamespace",
                                        "args": {
                                          "1": {
                                            "type": "literal",
                                            "value": "future"
                                          },
                                          "quietly": {
                                            "type": "literal",
                                            "value": true
                                          }
                                        }
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "{",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "warning",
                                        "args": [
                                          {
                                            "type": "literal",
                                            "value": "Cannot cancel running job in R"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "return",
                        "args": [
                          {
                            "type": "literal",
                            "value": false
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "NULL",
                    "value": []
                  }
                ]
              },
              "clear": {
                "type": "call",
                "fun": "function",
                "args": [
                  {
                    "type": "pairlist",
                    "value": "completed"
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "%in%",
                            "args": [
                              {
                                "type": "name",
                                "value": "type"
                              },
                              {
                                "type": "call",
                                "fun": "c",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": "completed"
                                  },
                                  {
                                    "type": "literal",
                                    "value": "all"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "private"
                                      },
                                      {
                                        "type": "name",
                                        "value": ".completed"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "list",
                                    "args": []
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "%in%",
                            "args": [
                              {
                                "type": "name",
                                "value": "type"
                              },
                              {
                                "type": "call",
                                "fun": "c",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": "failed"
                                  },
                                  {
                                    "type": "literal",
                                    "value": "all"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "private"
                                      },
                                      {
                                        "type": "name",
                                        "value": ".failed"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "list",
                                    "args": []
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "invisible",
                        "args": [
                          {
                            "type": "name",
                            "value": "self"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "NULL",
                    "value": []
                  }
                ]
              },
              "get_stats": {
                "type": "call",
                "fun": "function",
                "args": [
                  {
                    "type": "NULL",
                    "value": []
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": ["$", "private", "monitor_stats"],
                        "args": []
                      }
                    ]
                  },
                  {
                    "type": "NULL",
                    "value": []
                  }
                ]
              },
              "get_stats_history": {
                "type": "call",
                "fun": "function",
                "args": [
                  {
                    "type": "NULL",
                    "value": []
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "private"
                          },
                          {
                            "type": "name",
                            "value": ".stats"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "NULL",
                    "value": []
                  }
                ]
              },
              "print": {
                "type": "call",
                "fun": "function",
                "args": [
                  {
                    "type": "NULL",
                    "value": []
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "cat",
                        "args": [
                          {
                            "type": "literal",
                            "value": "TDMx Job Queue\n"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "cat",
                        "args": [
                          {
                            "type": "literal",
                            "value": "--------------\n"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "cat",
                        "args": [
                          {
                            "type": "literal",
                            "value": "Max workers:  "
                          },
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "private"
                              },
                              {
                                "type": "name",
                                "value": ".max_workers"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "\n"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "cat",
                        "args": [
                          {
                            "type": "literal",
                            "value": "Queued:       "
                          },
                          {
                            "type": "call",
                            "fun": "length",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "private"
                                  },
                                  {
                                    "type": "name",
                                    "value": ".queue"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "\n"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "cat",
                        "args": [
                          {
                            "type": "literal",
                            "value": "Running:      "
                          },
                          {
                            "type": "call",
                            "fun": "length",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "private"
                                  },
                                  {
                                    "type": "name",
                                    "value": ".running"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "\n"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "cat",
                        "args": [
                          {
                            "type": "literal",
                            "value": "Completed:    "
                          },
                          {
                            "type": "call",
                            "fun": "length",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "private"
                                  },
                                  {
                                    "type": "name",
                                    "value": ".completed"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "\n"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "cat",
                        "args": [
                          {
                            "type": "literal",
                            "value": "Failed:       "
                          },
                          {
                            "type": "call",
                            "fun": "length",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "private"
                                  },
                                  {
                                    "type": "name",
                                    "value": ".failed"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "\n"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "cat",
                        "args": [
                          {
                            "type": "literal",
                            "value": "Cache size:   "
                          },
                          {
                            "type": "call",
                            "fun": "length",
                            "args": [
                              {
                                "type": "call",
                                "fun": "ls",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "private"
                                      },
                                      {
                                        "type": "name",
                                        "value": ".result_cache"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": " results\n"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": ">",
                            "args": [
                              {
                                "type": "call",
                                "fun": "length",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "private"
                                      },
                                      {
                                        "type": "name",
                                        "value": ".queue"
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": 0
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "cat",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": "\nQueued jobs:\n"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "for",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "job"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "private"
                                      },
                                      {
                                        "type": "name",
                                        "value": ".queue"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "{",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "cat",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "sprintf",
                                            "args": [
                                              {
                                                "type": "literal",
                                                "value": "  %s (priority: %d, type: %s)\n"
                                              },
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "job"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "id"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "job"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "priority"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "job"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "type"
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": ">",
                            "args": [
                              {
                                "type": "call",
                                "fun": "length",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "private"
                                      },
                                      {
                                        "type": "name",
                                        "value": ".running"
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": 0
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "cat",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": "\nRunning jobs:\n"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "for",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "job"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "private"
                                      },
                                      {
                                        "type": "name",
                                        "value": ".running"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "{",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "<-",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "runtime"
                                          },
                                          {
                                            "type": "call",
                                            "fun": "difftime",
                                            "args": {
                                              "1": {
                                                "type": "call",
                                                "fun": "Sys.time",
                                                "args": []
                                              },
                                              "2": {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "job"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "start_time"
                                                  }
                                                ]
                                              },
                                              "units": {
                                                "type": "literal",
                                                "value": "secs"
                                              }
                                            }
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "cat",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "sprintf",
                                            "args": [
                                              {
                                                "type": "literal",
                                                "value": "  %s (runtime: %.1fs, type: %s)\n"
                                              },
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "job"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "id"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "name",
                                                "value": "runtime"
                                              },
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "job"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "type"
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "invisible",
                        "args": [
                          {
                            "type": "name",
                            "value": "self"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "NULL",
                    "value": []
                  }
                ]
              },
              "clear_cache": {
                "type": "call",
                "fun": "function",
                "args": [
                  {
                    "type": "pairlist",
                    "value": ["TRUE", "FALSE"]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "name",
                            "value": "memory"
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "rm",
                                "args": {
                                  "list": {
                                    "type": "call",
                                    "fun": "ls",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "private"
                                          },
                                          {
                                            "type": "name",
                                            "value": ".result_cache"
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  "envir": {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "private"
                                      },
                                      {
                                        "type": "name",
                                        "value": ".result_cache"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "type": "call",
                                "fun": "gc",
                                "args": {
                                  "verbose": {
                                    "type": "literal",
                                    "value": false
                                  }
                                }
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "&&",
                            "args": [
                              {
                                "type": "name",
                                "value": "disk"
                              },
                              {
                                "type": "call",
                                "fun": "!",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "is.null",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "private"
                                          },
                                          {
                                            "type": "name",
                                            "value": ".cache_dir"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "cache_files"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "list.files",
                                    "args": {
                                      "1": {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "private"
                                          },
                                          {
                                            "type": "name",
                                            "value": ".cache_dir"
                                          }
                                        ]
                                      },
                                      "pattern": {
                                        "type": "literal",
                                        "value": "\\.rds$"
                                      },
                                      "full.names": {
                                        "type": "literal",
                                        "value": true
                                      }
                                    }
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "file.remove",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "cache_files"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "invisible",
                        "args": [
                          {
                            "type": "name",
                            "value": "self"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "NULL",
                    "value": []
                  }
                ]
              },
              "wait_all": {
                "type": "call",
                "fun": "function",
                "args": [
                  {
                    "type": "pairlist",
                    "value": "600"
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "start_time"
                          },
                          {
                            "type": "call",
                            "fun": "Sys.time",
                            "args": []
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "while",
                        "args": [
                          {
                            "type": "call",
                            "fun": "||",
                            "args": [
                              {
                                "type": "call",
                                "fun": ">",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "length",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "private"
                                          },
                                          {
                                            "type": "name",
                                            "value": ".queue"
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "type": "literal",
                                    "value": 0
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": ">",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "length",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "private"
                                          },
                                          {
                                            "type": "name",
                                            "value": ".running"
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "type": "literal",
                                    "value": 0
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "if",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": ">",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "difftime",
                                        "args": {
                                          "1": {
                                            "type": "call",
                                            "fun": "Sys.time",
                                            "args": []
                                          },
                                          "2": {
                                            "type": "name",
                                            "value": "start_time"
                                          },
                                          "units": {
                                            "type": "literal",
                                            "value": "secs"
                                          }
                                        }
                                      },
                                      {
                                        "type": "name",
                                        "value": "timeout"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "{",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "warning",
                                        "args": [
                                          {
                                            "type": "literal",
                                            "value": "Timeout waiting for all jobs"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "break",
                                        "args": []
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "Sys.sleep",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": 0.5
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "invisible",
                        "args": [
                          {
                            "type": "name",
                            "value": "self"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "NULL",
                    "value": []
                  }
                ]
              }
            }
          }
        }
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "get_job_queue"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": ["NULL", "NULL"]
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "!",
                    "args": [
                      {
                        "type": "call",
                        "fun": "exists",
                        "args": {
                          "1": {
                            "type": "literal",
                            "value": ".tdmx_job_queue"
                          },
                          "envir": {
                            "type": "name",
                            "value": ".GlobalEnv"
                          }
                        }
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<<-",
                        "args": [
                          {
                            "type": "name",
                            "value": ".tdmx_job_queue"
                          },
                          {
                            "type": "call",
                            "fun": ["$", "JobQueue", "new"],
                            "args": {
                              "max_workers": {
                                "type": "name",
                                "value": "max_workers"
                              },
                              "cache_dir": {
                                "type": "call",
                                "fun": "%||%",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "cache_dir"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "file.path",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "tempdir",
                                        "args": []
                                      },
                                      {
                                        "type": "literal",
                                        "value": "tdmx_job_cache"
                                      }
                                    ]
                                  }
                                ]
                              }
                            }
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "return",
                "args": [
                  {
                    "type": "name",
                    "value": ".tdmx_job_queue"
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "submit_stan_job"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": ["", "5", "NULL"]
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "queue"
                  },
                  {
                    "type": "call",
                    "fun": "get_job_queue",
                    "args": []
                  }
                ]
              },
              {
                "type": "call",
                "fun": ["$", "queue", "submit"],
                "args": {
                  "type": {
                    "type": "literal",
                    "value": "stan_fit"
                  },
                  "spec": {
                    "type": "call",
                    "fun": "list",
                    "args": [
                      {
                        "type": "name",
                        "value": "..."
                      }
                    ]
                  },
                  "priority": {
                    "type": "name",
                    "value": "priority"
                  },
                  "callback": {
                    "type": "name",
                    "value": "callback"
                  }
                }
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "submit_pta_job"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": ["", "5", "NULL"]
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "queue"
                  },
                  {
                    "type": "call",
                    "fun": "get_job_queue",
                    "args": []
                  }
                ]
              },
              {
                "type": "call",
                "fun": ["$", "queue", "submit"],
                "args": {
                  "type": {
                    "type": "literal",
                    "value": "pta_calculation"
                  },
                  "spec": {
                    "type": "call",
                    "fun": "list",
                    "args": [
                      {
                        "type": "name",
                        "value": "..."
                      }
                    ]
                  },
                  "priority": {
                    "type": "name",
                    "value": "priority"
                  },
                  "callback": {
                    "type": "name",
                    "value": "callback"
                  }
                }
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "submit_batch_job"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": ["", "", "3", "NULL"]
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "queue"
                  },
                  {
                    "type": "call",
                    "fun": "get_job_queue",
                    "args": []
                  }
                ]
              },
              {
                "type": "call",
                "fun": ["$", "queue", "submit"],
                "args": {
                  "type": {
                    "type": "literal",
                    "value": "batch_processing"
                  },
                  "spec": {
                    "type": "call",
                    "fun": "list",
                    "args": {
                      "data": {
                        "type": "name",
                        "value": "data"
                      },
                      "fun": {
                        "type": "name",
                        "value": "fun"
                      }
                    }
                  },
                  "priority": {
                    "type": "name",
                    "value": "priority"
                  },
                  "callback": {
                    "type": "name",
                    "value": "callback"
                  }
                }
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "create_queue_monitor"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": ["NULL", "NULL", "2"]
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "is.null",
                    "args": [
                      {
                        "type": "name",
                        "value": "queue"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "queue"
                          },
                          {
                            "type": "call",
                            "fun": "get_job_queue",
                            "args": []
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "monitoring"
                  },
                  {
                    "type": "literal",
                    "value": true
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "monitor"
                  },
                  {
                    "type": "call",
                    "fun": "function",
                    "args": [
                      {
                        "type": "NULL",
                        "value": []
                      },
                      {
                        "type": "call",
                        "fun": "{",
                        "args": [
                          {
                            "type": "call",
                            "fun": "while",
                            "args": [
                              {
                                "type": "name",
                                "value": "monitoring"
                              },
                              {
                                "type": "call",
                                "fun": "{",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "<-",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "stats"
                                      },
                                      {
                                        "type": "call",
                                        "fun": ["$", "queue", "get_stats"],
                                        "args": []
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "if",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "!",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "is.null",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "session"
                                              }
                                            ]
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "{",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": ["$", "session", "sendCustomMessage"],
                                            "args": [
                                              {
                                                "type": "literal",
                                                "value": "updateQueueStats"
                                              },
                                              {
                                                "type": "name",
                                                "value": "stats"
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "Sys.sleep",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "update_interval"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "NULL",
                        "value": []
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "requireNamespace",
                    "args": {
                      "1": {
                        "type": "literal",
                        "value": "future"
                      },
                      "quietly": {
                        "type": "literal",
                        "value": true
                      }
                    }
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": ["::", "future", "future"],
                        "args": {
                          "1": {
                            "type": "call",
                            "fun": "monitor",
                            "args": []
                          },
                          "lazy": {
                            "type": "literal",
                            "value": false
                          }
                        }
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "list",
                "args": {
                  "stop": {
                    "type": "call",
                    "fun": "function",
                    "args": [
                      {
                        "type": "NULL",
                        "value": []
                      },
                      {
                        "type": "call",
                        "fun": "{",
                        "args": [
                          {
                            "type": "call",
                            "fun": "<<-",
                            "args": [
                              {
                                "type": "name",
                                "value": "monitoring"
                              },
                              {
                                "type": "literal",
                                "value": false
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "NULL",
                        "value": []
                      }
                    ]
                  },
                  "queue": {
                    "type": "name",
                    "value": "queue"
                  }
                }
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "message",
    "args": [
      {
        "type": "literal",
        "value": "Job queue system loaded. Use get_job_queue() to access."
      }
    ]
  }
]
