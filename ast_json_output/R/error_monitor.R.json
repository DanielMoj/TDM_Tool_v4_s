[
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": ".check_error_monitor_dependencies"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "NULL",
            "value": []
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "required_packages"
                  },
                  {
                    "type": "call",
                    "fun": "c",
                    "args": [
                      {
                        "type": "literal",
                        "value": "DBI"
                      },
                      {
                        "type": "literal",
                        "value": "jsonlite"
                      },
                      {
                        "type": "literal",
                        "value": "digest"
                      },
                      {
                        "type": "literal",
                        "value": "lubridate"
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "missing_packages"
                  },
                  {
                    "type": "call",
                    "fun": "character",
                    "args": []
                  }
                ]
              },
              {
                "type": "call",
                "fun": "for",
                "args": [
                  {
                    "type": "name",
                    "value": "pkg"
                  },
                  {
                    "type": "name",
                    "value": "required_packages"
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "!",
                            "args": [
                              {
                                "type": "call",
                                "fun": "requireNamespace",
                                "args": {
                                  "1": {
                                    "type": "name",
                                    "value": "pkg"
                                  },
                                  "quietly": {
                                    "type": "literal",
                                    "value": true
                                  }
                                }
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "missing_packages"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "c",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "missing_packages"
                                      },
                                      {
                                        "type": "name",
                                        "value": "pkg"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": ">",
                    "args": [
                      {
                        "type": "call",
                        "fun": "length",
                        "args": [
                          {
                            "type": "name",
                            "value": "missing_packages"
                          }
                        ]
                      },
                      {
                        "type": "literal",
                        "value": 0
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "stop",
                        "args": [
                          {
                            "type": "call",
                            "fun": "sprintf",
                            "args": [
                              {
                                "type": "literal",
                                "value": "Error monitor requires the following packages: %s\nPlease install them with: install.packages(c(%s))"
                              },
                              {
                                "type": "call",
                                "fun": "paste",
                                "args": {
                                  "1": {
                                    "type": "name",
                                    "value": "missing_packages"
                                  },
                                  "collapse": {
                                    "type": "literal",
                                    "value": ", "
                                  }
                                }
                              },
                              {
                                "type": "call",
                                "fun": "paste",
                                "args": {
                                  "1": {
                                    "type": "call",
                                    "fun": "sprintf",
                                    "args": [
                                      {
                                        "type": "literal",
                                        "value": "\"%s\""
                                      },
                                      {
                                        "type": "name",
                                        "value": "missing_packages"
                                      }
                                    ]
                                  },
                                  "collapse": {
                                    "type": "literal",
                                    "value": ", "
                                  }
                                }
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": ".check_error_monitor_dependencies",
    "args": []
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": ".error_monitor_config"
      },
      {
        "type": "call",
        "fun": "new.env",
        "args": {
          "parent": {
            "type": "call",
            "fun": "emptyenv",
            "args": []
          }
        }
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "call",
        "fun": "$",
        "args": [
          {
            "type": "name",
            "value": ".error_monitor_config"
          },
          {
            "type": "name",
            "value": "max_errors_in_memory"
          }
        ]
      },
      {
        "type": "literal",
        "value": 1000
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "call",
        "fun": "$",
        "args": [
          {
            "type": "name",
            "value": ".error_monitor_config"
          },
          {
            "type": "name",
            "value": "alert_threshold_critical"
          }
        ]
      },
      {
        "type": "literal",
        "value": 5
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "call",
        "fun": "$",
        "args": [
          {
            "type": "name",
            "value": ".error_monitor_config"
          },
          {
            "type": "name",
            "value": "alert_threshold_warning"
          }
        ]
      },
      {
        "type": "literal",
        "value": 20
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "call",
        "fun": "$",
        "args": [
          {
            "type": "name",
            "value": ".error_monitor_config"
          },
          {
            "type": "name",
            "value": "alert_window_minutes"
          }
        ]
      },
      {
        "type": "literal",
        "value": 5
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "call",
        "fun": "$",
        "args": [
          {
            "type": "name",
            "value": ".error_monitor_config"
          },
          {
            "type": "name",
            "value": "db_enabled"
          }
        ]
      },
      {
        "type": "literal",
        "value": false
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "call",
        "fun": "$",
        "args": [
          {
            "type": "name",
            "value": ".error_monitor_config"
          },
          {
            "type": "name",
            "value": "email_alerts"
          }
        ]
      },
      {
        "type": "literal",
        "value": false
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "call",
        "fun": "$",
        "args": [
          {
            "type": "name",
            "value": ".error_monitor_config"
          },
          {
            "type": "name",
            "value": "slack_webhook"
          }
        ]
      },
      {
        "type": "NULL",
        "value": []
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": ".error_store"
      },
      {
        "type": "call",
        "fun": "new.env",
        "args": {
          "parent": {
            "type": "call",
            "fun": "emptyenv",
            "args": []
          }
        }
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "call",
        "fun": "$",
        "args": [
          {
            "type": "name",
            "value": ".error_store"
          },
          {
            "type": "name",
            "value": "errors"
          }
        ]
      },
      {
        "type": "call",
        "fun": "list",
        "args": []
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "call",
        "fun": "$",
        "args": [
          {
            "type": "name",
            "value": ".error_store"
          },
          {
            "type": "name",
            "value": "metrics"
          }
        ]
      },
      {
        "type": "call",
        "fun": "list",
        "args": []
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "call",
        "fun": "$",
        "args": [
          {
            "type": "name",
            "value": ".error_store"
          },
          {
            "type": "name",
            "value": "alerts_sent"
          }
        ]
      },
      {
        "type": "call",
        "fun": "list",
        "args": []
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "init_error_monitor"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": ["NULL", "list()"]
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "for",
                "args": [
                  {
                    "type": "name",
                    "value": "name"
                  },
                  {
                    "type": "call",
                    "fun": "names",
                    "args": [
                      {
                        "type": "name",
                        "value": "config"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "%in%",
                            "args": [
                              {
                                "type": "name",
                                "value": "name"
                              },
                              {
                                "type": "call",
                                "fun": "ls",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": ".error_monitor_config"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "<-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "[[",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": ".error_monitor_config"
                                      },
                                      {
                                        "type": "name",
                                        "value": "name"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "[[",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "config"
                                      },
                                      {
                                        "type": "name",
                                        "value": "name"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "!",
                    "args": [
                      {
                        "type": "call",
                        "fun": "is.null",
                        "args": [
                          {
                            "type": "name",
                            "value": "db_connection"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": ".error_monitor_config"
                              },
                              {
                                "type": "name",
                                "value": "db_connection"
                              }
                            ]
                          },
                          {
                            "type": "name",
                            "value": "db_connection"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": ".error_monitor_config"
                              },
                              {
                                "type": "name",
                                "value": "db_enabled"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": true
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "create_error_tables",
                        "args": [
                          {
                            "type": "name",
                            "value": "db_connection"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": ".error_store"
                      },
                      {
                        "type": "name",
                        "value": "metrics"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "list",
                    "args": {
                      "total_errors": {
                        "type": "literal",
                        "value": 0
                      },
                      "errors_by_severity": {
                        "type": "call",
                        "fun": "list",
                        "args": {
                          "CRITICAL": {
                            "type": "literal",
                            "value": 0
                          },
                          "ERROR": {
                            "type": "literal",
                            "value": 0
                          },
                          "WARNING": {
                            "type": "literal",
                            "value": 0
                          },
                          "INFO": {
                            "type": "literal",
                            "value": 0
                          }
                        }
                      },
                      "errors_by_module": {
                        "type": "call",
                        "fun": "list",
                        "args": []
                      },
                      "error_rate_per_minute": {
                        "type": "call",
                        "fun": "numeric",
                        "args": []
                      },
                      "last_error_time": {
                        "type": "NULL",
                        "value": []
                      },
                      "uptime_start": {
                        "type": "call",
                        "fun": "Sys.time",
                        "args": []
                      }
                    }
                  }
                ]
              },
              {
                "type": "call",
                "fun": "schedule_cleanup",
                "args": []
              },
              {
                "type": "call",
                "fun": "message",
                "args": [
                  {
                    "type": "literal",
                    "value": "Error monitoring system initialized"
                  }
                ]
              },
              {
                "type": "call",
                "fun": "return",
                "args": [
                  {
                    "type": "literal",
                    "value": true
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "log_error"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": ["", "", "ERROR", "NA", "list()", "NULL"]
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "valid_severities"
                  },
                  {
                    "type": "call",
                    "fun": "c",
                    "args": [
                      {
                        "type": "literal",
                        "value": "CRITICAL"
                      },
                      {
                        "type": "literal",
                        "value": "ERROR"
                      },
                      {
                        "type": "literal",
                        "value": "WARNING"
                      },
                      {
                        "type": "literal",
                        "value": "INFO"
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "!",
                    "args": [
                      {
                        "type": "call",
                        "fun": "%in%",
                        "args": [
                          {
                            "type": "name",
                            "value": "severity"
                          },
                          {
                            "type": "name",
                            "value": "valid_severities"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "severity"
                          },
                          {
                            "type": "literal",
                            "value": "ERROR"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "error_id"
                  },
                  {
                    "type": "call",
                    "fun": "generate_error_id",
                    "args": []
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "error_record"
                  },
                  {
                    "type": "call",
                    "fun": "list",
                    "args": {
                      "id": {
                        "type": "name",
                        "value": "error_id"
                      },
                      "timestamp": {
                        "type": "call",
                        "fun": "Sys.time",
                        "args": []
                      },
                      "error_type": {
                        "type": "name",
                        "value": "error_type"
                      },
                      "message": {
                        "type": "name",
                        "value": "message"
                      },
                      "severity": {
                        "type": "name",
                        "value": "severity"
                      },
                      "module": {
                        "type": "name",
                        "value": "module"
                      },
                      "context": {
                        "type": "name",
                        "value": "context"
                      },
                      "stack_trace": {
                        "type": "call",
                        "fun": "%||%",
                        "args": [
                          {
                            "type": "name",
                            "value": "stack_trace"
                          },
                          {
                            "type": "call",
                            "fun": "capture_stack_trace",
                            "args": []
                          }
                        ]
                      },
                      "session_id": {
                        "type": "call",
                        "fun": "get_session_id",
                        "args": []
                      },
                      "user": {
                        "type": "call",
                        "fun": "get_current_user",
                        "args": []
                      },
                      "environment": {
                        "type": "call",
                        "fun": "Sys.getenv",
                        "args": [
                          {
                            "type": "literal",
                            "value": "R_ENV"
                          },
                          {
                            "type": "literal",
                            "value": "production"
                          }
                        ]
                      }
                    }
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": ">=",
                    "args": [
                      {
                        "type": "call",
                        "fun": "length",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": ".error_store"
                              },
                              {
                                "type": "name",
                                "value": "errors"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": ".error_monitor_config"
                          },
                          {
                            "type": "name",
                            "value": "max_errors_in_memory"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": ".error_store"
                              },
                              {
                                "type": "name",
                                "value": "errors"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "tail",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": ".error_store"
                                  },
                                  {
                                    "type": "name",
                                    "value": "errors"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "-",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": ".error_monitor_config"
                                      },
                                      {
                                        "type": "name",
                                        "value": "max_errors_in_memory"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "literal",
                                    "value": 1
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "[[",
                    "args": [
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": ".error_store"
                          },
                          {
                            "type": "name",
                            "value": "errors"
                          }
                        ]
                      },
                      {
                        "type": "name",
                        "value": "error_id"
                      }
                    ]
                  },
                  {
                    "type": "name",
                    "value": "error_record"
                  }
                ]
              },
              {
                "type": "call",
                "fun": "update_error_metrics",
                "args": [
                  {
                    "type": "name",
                    "value": "error_record"
                  }
                ]
              },
              {
                "type": "call",
                "fun": "check_alert_conditions",
                "args": [
                  {
                    "type": "name",
                    "value": "error_record"
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": ".error_monitor_config"
                      },
                      {
                        "type": "name",
                        "value": "db_enabled"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "store_error_in_db",
                        "args": [
                          {
                            "type": "name",
                            "value": "error_record"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "write_error_log",
                "args": [
                  {
                    "type": "name",
                    "value": "error_record"
                  }
                ]
              },
              {
                "type": "call",
                "fun": "return",
                "args": [
                  {
                    "type": "name",
                    "value": "error_id"
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "create_error_tables"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": ""
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": ["::", "DBI", "dbExecute"],
                "args": [
                  {
                    "type": "name",
                    "value": "con"
                  },
                  {
                    "type": "literal",
                    "value": "\n    CREATE TABLE IF NOT EXISTS error_log (\n      id TEXT PRIMARY KEY,\n      timestamp TIMESTAMP,\n      error_type TEXT,\n      message TEXT,\n      severity TEXT,\n      module TEXT,\n      context TEXT,\n      stack_trace TEXT,\n      session_id TEXT,\n      user_name TEXT,\n      environment TEXT\n    )\n  "
                  }
                ]
              },
              {
                "type": "call",
                "fun": ["::", "DBI", "dbExecute"],
                "args": [
                  {
                    "type": "name",
                    "value": "con"
                  },
                  {
                    "type": "literal",
                    "value": "\n    CREATE INDEX IF NOT EXISTS idx_error_timestamp ON error_log(timestamp);\n    CREATE INDEX IF NOT EXISTS idx_error_severity ON error_log(severity);\n    CREATE INDEX IF NOT EXISTS idx_error_type ON error_log(error_type);\n  "
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "store_error_in_db"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": ""
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "con"
                  },
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": ".error_monitor_config"
                      },
                      {
                        "type": "name",
                        "value": "db_connection"
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "is.null",
                    "args": [
                      {
                        "type": "name",
                        "value": "con"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "return",
                    "args": [
                      {
                        "type": "literal",
                        "value": false
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "tryCatch",
                "args": {
                  "1": {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "context_json"
                          },
                          {
                            "type": "call",
                            "fun": ["::", "jsonlite", "toJSON"],
                            "args": {
                              "1": {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "error_record"
                                  },
                                  {
                                    "type": "name",
                                    "value": "context"
                                  }
                                ]
                              },
                              "auto_unbox": {
                                "type": "literal",
                                "value": true
                              }
                            }
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "stack_json"
                          },
                          {
                            "type": "call",
                            "fun": ["::", "jsonlite", "toJSON"],
                            "args": {
                              "1": {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "error_record"
                                  },
                                  {
                                    "type": "name",
                                    "value": "stack_trace"
                                  }
                                ]
                              },
                              "auto_unbox": {
                                "type": "literal",
                                "value": true
                              }
                            }
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": ["::", "DBI", "dbExecute"],
                        "args": [
                          {
                            "type": "name",
                            "value": "con"
                          },
                          {
                            "type": "literal",
                            "value": "\n      INSERT INTO error_log (id, timestamp, error_type, message, severity, \n                            module, context, stack_trace, session_id, user_name, environment)\n      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n    "
                          },
                          {
                            "type": "call",
                            "fun": "list",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "error_record"
                                  },
                                  {
                                    "type": "name",
                                    "value": "id"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "error_record"
                                  },
                                  {
                                    "type": "name",
                                    "value": "timestamp"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "error_record"
                                  },
                                  {
                                    "type": "name",
                                    "value": "error_type"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "error_record"
                                  },
                                  {
                                    "type": "name",
                                    "value": "message"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "error_record"
                                  },
                                  {
                                    "type": "name",
                                    "value": "severity"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "error_record"
                                  },
                                  {
                                    "type": "name",
                                    "value": "module"
                                  }
                                ]
                              },
                              {
                                "type": "name",
                                "value": "context_json"
                              },
                              {
                                "type": "name",
                                "value": "stack_json"
                              },
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "error_record"
                                  },
                                  {
                                    "type": "name",
                                    "value": "session_id"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "error_record"
                                  },
                                  {
                                    "type": "name",
                                    "value": "user"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "error_record"
                                  },
                                  {
                                    "type": "name",
                                    "value": "environment"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "return",
                        "args": [
                          {
                            "type": "literal",
                            "value": true
                          }
                        ]
                      }
                    ]
                  },
                  "error": {
                    "type": "call",
                    "fun": "function",
                    "args": [
                      {
                        "type": "pairlist",
                        "value": ""
                      },
                      {
                        "type": "call",
                        "fun": "{",
                        "args": [
                          {
                            "type": "call",
                            "fun": "warning",
                            "args": [
                              {
                                "type": "call",
                                "fun": "sprintf",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": "Failed to store error in database: %s"
                                  },
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "e"
                                      },
                                      {
                                        "type": "name",
                                        "value": "message"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "return",
                            "args": [
                              {
                                "type": "literal",
                                "value": false
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "NULL",
                        "value": []
                      }
                    ]
                  }
                }
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "update_error_metrics"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": ""
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "metrics"
                  },
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": ".error_store"
                      },
                      {
                        "type": "name",
                        "value": "metrics"
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": "metrics"
                      },
                      {
                        "type": "name",
                        "value": "total_errors"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "+",
                    "args": [
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "metrics"
                          },
                          {
                            "type": "name",
                            "value": "total_errors"
                          }
                        ]
                      },
                      {
                        "type": "literal",
                        "value": 1
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "[[",
                    "args": [
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "metrics"
                          },
                          {
                            "type": "name",
                            "value": "errors_by_severity"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "error_record"
                          },
                          {
                            "type": "name",
                            "value": "severity"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "+",
                    "args": [
                      {
                        "type": "call",
                        "fun": "(",
                        "args": [
                          {
                            "type": "call",
                            "fun": "%||%",
                            "args": [
                              {
                                "type": "call",
                                "fun": "[[",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "metrics"
                                      },
                                      {
                                        "type": "name",
                                        "value": "errors_by_severity"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "error_record"
                                      },
                                      {
                                        "type": "name",
                                        "value": "severity"
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": 0
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "literal",
                        "value": 1
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "!",
                    "args": [
                      {
                        "type": "call",
                        "fun": "is.na",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "error_record"
                              },
                              {
                                "type": "name",
                                "value": "module"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "[[",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "metrics"
                                  },
                                  {
                                    "type": "name",
                                    "value": "errors_by_module"
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "error_record"
                                  },
                                  {
                                    "type": "name",
                                    "value": "module"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "+",
                            "args": [
                              {
                                "type": "call",
                                "fun": "(",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "%||%",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "[[",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "metrics"
                                              },
                                              {
                                                "type": "name",
                                                "value": "errors_by_module"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "error_record"
                                              },
                                              {
                                                "type": "name",
                                                "value": "module"
                                              }
                                            ]
                                          }
                                        ]
                                      },
                                      {
                                        "type": "literal",
                                        "value": 0
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": 1
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "current_minute"
                  },
                  {
                    "type": "call",
                    "fun": ["::", "lubridate", "floor_date"],
                    "args": [
                      {
                        "type": "call",
                        "fun": "Sys.time",
                        "args": []
                      },
                      {
                        "type": "literal",
                        "value": "minute"
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "minute_key"
                  },
                  {
                    "type": "call",
                    "fun": "as.character",
                    "args": [
                      {
                        "type": "name",
                        "value": "current_minute"
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "||",
                    "args": [
                      {
                        "type": "call",
                        "fun": "==",
                        "args": [
                          {
                            "type": "call",
                            "fun": "length",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "metrics"
                                  },
                                  {
                                    "type": "name",
                                    "value": "error_rate_per_minute"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": 0
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "!=",
                        "args": [
                          {
                            "type": "call",
                            "fun": "[",
                            "args": [
                              {
                                "type": "call",
                                "fun": "names",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "metrics"
                                      },
                                      {
                                        "type": "name",
                                        "value": "error_rate_per_minute"
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "call",
                                "fun": "length",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "metrics"
                                      },
                                      {
                                        "type": "name",
                                        "value": "error_rate_per_minute"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "name",
                            "value": "minute_key"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "[",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "metrics"
                                  },
                                  {
                                    "type": "name",
                                    "value": "error_rate_per_minute"
                                  }
                                ]
                              },
                              {
                                "type": "name",
                                "value": "minute_key"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": 1
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "[",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "metrics"
                                  },
                                  {
                                    "type": "name",
                                    "value": "error_rate_per_minute"
                                  }
                                ]
                              },
                              {
                                "type": "name",
                                "value": "minute_key"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "+",
                            "args": [
                              {
                                "type": "call",
                                "fun": "[",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "metrics"
                                      },
                                      {
                                        "type": "name",
                                        "value": "error_rate_per_minute"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "name",
                                    "value": "minute_key"
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": 1
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "cutoff"
                  },
                  {
                    "type": "call",
                    "fun": "-",
                    "args": [
                      {
                        "type": "call",
                        "fun": "Sys.time",
                        "args": []
                      },
                      {
                        "type": "call",
                        "fun": ["::", "lubridate", "hours"],
                        "args": [
                          {
                            "type": "literal",
                            "value": 1
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "keep_times"
                  },
                  {
                    "type": "call",
                    "fun": ">=",
                    "args": [
                      {
                        "type": "call",
                        "fun": "as.POSIXct",
                        "args": [
                          {
                            "type": "call",
                            "fun": "names",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "metrics"
                                  },
                                  {
                                    "type": "name",
                                    "value": "error_rate_per_minute"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "name",
                        "value": "cutoff"
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": "metrics"
                      },
                      {
                        "type": "name",
                        "value": "error_rate_per_minute"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "[",
                    "args": [
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "metrics"
                          },
                          {
                            "type": "name",
                            "value": "error_rate_per_minute"
                          }
                        ]
                      },
                      {
                        "type": "name",
                        "value": "keep_times"
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": "metrics"
                      },
                      {
                        "type": "name",
                        "value": "last_error_time"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": "error_record"
                      },
                      {
                        "type": "name",
                        "value": "timestamp"
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": ".error_store"
                      },
                      {
                        "type": "name",
                        "value": "metrics"
                      }
                    ]
                  },
                  {
                    "type": "name",
                    "value": "metrics"
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "check_alert_conditions"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": ""
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "==",
                    "args": [
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "error_record"
                          },
                          {
                            "type": "name",
                            "value": "severity"
                          }
                        ]
                      },
                      {
                        "type": "literal",
                        "value": "CRITICAL"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "send_alert",
                        "args": {
                          "level": {
                            "type": "literal",
                            "value": "CRITICAL"
                          },
                          "subject": {
                            "type": "call",
                            "fun": "sprintf",
                            "args": [
                              {
                                "type": "literal",
                                "value": "CRITICAL ERROR: %s"
                              },
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "error_record"
                                  },
                                  {
                                    "type": "name",
                                    "value": "error_type"
                                  }
                                ]
                              }
                            ]
                          },
                          "message": {
                            "type": "call",
                            "fun": "format_alert_message",
                            "args": [
                              {
                                "type": "name",
                                "value": "error_record"
                              }
                            ]
                          },
                          "error_id": {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "error_record"
                              },
                              {
                                "type": "name",
                                "value": "id"
                              }
                            ]
                          }
                        }
                      },
                      {
                        "type": "call",
                        "fun": "return",
                        "args": []
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "window_start"
                  },
                  {
                    "type": "call",
                    "fun": "-",
                    "args": [
                      {
                        "type": "call",
                        "fun": "Sys.time",
                        "args": []
                      },
                      {
                        "type": "call",
                        "fun": ["::", "lubridate", "minutes"],
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": ".error_monitor_config"
                              },
                              {
                                "type": "name",
                                "value": "alert_window_minutes"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "recent_errors"
                  },
                  {
                    "type": "call",
                    "fun": "Filter",
                    "args": [
                      {
                        "type": "call",
                        "fun": "function",
                        "args": [
                          {
                            "type": "pairlist",
                            "value": ""
                          },
                          {
                            "type": "call",
                            "fun": ">=",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "e"
                                  },
                                  {
                                    "type": "name",
                                    "value": "timestamp"
                                  }
                                ]
                              },
                              {
                                "type": "name",
                                "value": "window_start"
                              }
                            ]
                          },
                          {
                            "type": "NULL",
                            "value": []
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": ".error_store"
                          },
                          {
                            "type": "name",
                            "value": "errors"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "error_count"
                  },
                  {
                    "type": "call",
                    "fun": "length",
                    "args": [
                      {
                        "type": "name",
                        "value": "recent_errors"
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "critical_count"
                  },
                  {
                    "type": "call",
                    "fun": "sum",
                    "args": [
                      {
                        "type": "call",
                        "fun": "sapply",
                        "args": [
                          {
                            "type": "name",
                            "value": "recent_errors"
                          },
                          {
                            "type": "call",
                            "fun": "function",
                            "args": [
                              {
                                "type": "pairlist",
                                "value": ""
                              },
                              {
                                "type": "call",
                                "fun": "==",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "$",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "e"
                                      },
                                      {
                                        "type": "name",
                                        "value": "severity"
                                      }
                                    ]
                                  },
                                  {
                                    "type": "literal",
                                    "value": "CRITICAL"
                                  }
                                ]
                              },
                              {
                                "type": "NULL",
                                "value": []
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": ">=",
                    "args": [
                      {
                        "type": "name",
                        "value": "error_count"
                      },
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": ".error_monitor_config"
                          },
                          {
                            "type": "name",
                            "value": "alert_threshold_warning"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "!",
                            "args": [
                              {
                                "type": "call",
                                "fun": "has_recent_alert",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": "high_error_rate"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "send_alert",
                                "args": {
                                  "level": {
                                    "type": "literal",
                                    "value": "WARNING"
                                  },
                                  "subject": {
                                    "type": "call",
                                    "fun": "sprintf",
                                    "args": [
                                      {
                                        "type": "literal",
                                        "value": "High error rate: %d errors in %d minutes"
                                      },
                                      {
                                        "type": "name",
                                        "value": "error_count"
                                      },
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": ".error_monitor_config"
                                          },
                                          {
                                            "type": "name",
                                            "value": "alert_window_minutes"
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  "message": {
                                    "type": "call",
                                    "fun": "format_rate_alert",
                                    "args": [
                                      {
                                        "type": "name",
                                        "value": "recent_errors"
                                      }
                                    ]
                                  }
                                }
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": ">=",
                    "args": [
                      {
                        "type": "name",
                        "value": "critical_count"
                      },
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": ".error_monitor_config"
                          },
                          {
                            "type": "name",
                            "value": "alert_threshold_critical"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": "!",
                            "args": [
                              {
                                "type": "call",
                                "fun": "has_recent_alert",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": "critical_errors"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "send_alert",
                                "args": {
                                  "level": {
                                    "type": "literal",
                                    "value": "CRITICAL"
                                  },
                                  "subject": {
                                    "type": "call",
                                    "fun": "sprintf",
                                    "args": [
                                      {
                                        "type": "literal",
                                        "value": "Multiple critical errors: %d in %d minutes"
                                      },
                                      {
                                        "type": "name",
                                        "value": "critical_count"
                                      },
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": ".error_monitor_config"
                                          },
                                          {
                                            "type": "name",
                                            "value": "alert_window_minutes"
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  "message": {
                                    "type": "call",
                                    "fun": "format_rate_alert",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "Filter",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "function",
                                            "args": [
                                              {
                                                "type": "pairlist",
                                                "value": ""
                                              },
                                              {
                                                "type": "call",
                                                "fun": "==",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "$",
                                                    "args": [
                                                      {
                                                        "type": "name",
                                                        "value": "e"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": "severity"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "type": "literal",
                                                    "value": "CRITICAL"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "NULL",
                                                "value": []
                                              }
                                            ]
                                          },
                                          {
                                            "type": "name",
                                            "value": "recent_errors"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                }
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "check_error_patterns",
                "args": [
                  {
                    "type": "name",
                    "value": "recent_errors"
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "check_error_patterns"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": ""
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "<",
                    "args": [
                      {
                        "type": "call",
                        "fun": "length",
                        "args": [
                          {
                            "type": "name",
                            "value": "errors"
                          }
                        ]
                      },
                      {
                        "type": "literal",
                        "value": 5
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "return",
                    "args": []
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "error_types"
                  },
                  {
                    "type": "call",
                    "fun": "sapply",
                    "args": [
                      {
                        "type": "name",
                        "value": "errors"
                      },
                      {
                        "type": "call",
                        "fun": "function",
                        "args": [
                          {
                            "type": "pairlist",
                            "value": ""
                          },
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "e"
                              },
                              {
                                "type": "name",
                                "value": "error_type"
                              }
                            ]
                          },
                          {
                            "type": "NULL",
                            "value": []
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "type_counts"
                  },
                  {
                    "type": "call",
                    "fun": "table",
                    "args": [
                      {
                        "type": "name",
                        "value": "error_types"
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "for",
                "args": [
                  {
                    "type": "name",
                    "value": "error_type"
                  },
                  {
                    "type": "call",
                    "fun": "names",
                    "args": [
                      {
                        "type": "name",
                        "value": "type_counts"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "if",
                        "args": [
                          {
                            "type": "call",
                            "fun": ">=",
                            "args": [
                              {
                                "type": "call",
                                "fun": "[",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "type_counts"
                                  },
                                  {
                                    "type": "name",
                                    "value": "error_type"
                                  }
                                ]
                              },
                              {
                                "type": "literal",
                                "value": 5
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "if",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "!",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "has_recent_alert",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "paste0",
                                            "args": [
                                              {
                                                "type": "literal",
                                                "value": "repeated_"
                                              },
                                              {
                                                "type": "name",
                                                "value": "error_type"
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "{",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "send_alert",
                                        "args": {
                                          "level": {
                                            "type": "literal",
                                            "value": "WARNING"
                                          },
                                          "subject": {
                                            "type": "call",
                                            "fun": "sprintf",
                                            "args": [
                                              {
                                                "type": "literal",
                                                "value": "Repeated error pattern: %s (%d times)"
                                              },
                                              {
                                                "type": "name",
                                                "value": "error_type"
                                              },
                                              {
                                                "type": "call",
                                                "fun": "[",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "type_counts"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "error_type"
                                                  }
                                                ]
                                              }
                                            ]
                                          },
                                          "message": {
                                            "type": "call",
                                            "fun": "sprintf",
                                            "args": [
                                              {
                                                "type": "literal",
                                                "value": "Error '%s' has occurred %d times in the last %d minutes"
                                              },
                                              {
                                                "type": "name",
                                                "value": "error_type"
                                              },
                                              {
                                                "type": "call",
                                                "fun": "[",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": "type_counts"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "error_type"
                                                  }
                                                ]
                                              },
                                              {
                                                "type": "call",
                                                "fun": "$",
                                                "args": [
                                                  {
                                                    "type": "name",
                                                    "value": ".error_monitor_config"
                                                  },
                                                  {
                                                    "type": "name",
                                                    "value": "alert_window_minutes"
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        }
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "modules"
                  },
                  {
                    "type": "call",
                    "fun": "sapply",
                    "args": [
                      {
                        "type": "name",
                        "value": "errors"
                      },
                      {
                        "type": "call",
                        "fun": "function",
                        "args": [
                          {
                            "type": "pairlist",
                            "value": ""
                          },
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "e"
                              },
                              {
                                "type": "name",
                                "value": "module"
                              }
                            ]
                          },
                          {
                            "type": "NULL",
                            "value": []
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "modules"
                  },
                  {
                    "type": "call",
                    "fun": "[",
                    "args": [
                      {
                        "type": "name",
                        "value": "modules"
                      },
                      {
                        "type": "call",
                        "fun": "!",
                        "args": [
                          {
                            "type": "call",
                            "fun": "is.na",
                            "args": [
                              {
                                "type": "name",
                                "value": "modules"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": ">",
                    "args": [
                      {
                        "type": "call",
                        "fun": "length",
                        "args": [
                          {
                            "type": "name",
                            "value": "modules"
                          }
                        ]
                      },
                      {
                        "type": "literal",
                        "value": 0
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "module_counts"
                          },
                          {
                            "type": "call",
                            "fun": "table",
                            "args": [
                              {
                                "type": "name",
                                "value": "modules"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "for",
                        "args": [
                          {
                            "type": "name",
                            "value": "module"
                          },
                          {
                            "type": "call",
                            "fun": "names",
                            "args": [
                              {
                                "type": "name",
                                "value": "module_counts"
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "{",
                            "args": [
                              {
                                "type": "call",
                                "fun": "if",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": ">=",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "[",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "module_counts"
                                          },
                                          {
                                            "type": "name",
                                            "value": "module"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "literal",
                                        "value": 10
                                      }
                                    ]
                                  },
                                  {
                                    "type": "call",
                                    "fun": "{",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "if",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "!",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "has_recent_alert",
                                                "args": [
                                                  {
                                                    "type": "call",
                                                    "fun": "paste0",
                                                    "args": [
                                                      {
                                                        "type": "literal",
                                                        "value": "module_"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": "module"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            ]
                                          },
                                          {
                                            "type": "call",
                                            "fun": "{",
                                            "args": [
                                              {
                                                "type": "call",
                                                "fun": "send_alert",
                                                "args": {
                                                  "level": {
                                                    "type": "literal",
                                                    "value": "WARNING"
                                                  },
                                                  "subject": {
                                                    "type": "call",
                                                    "fun": "sprintf",
                                                    "args": [
                                                      {
                                                        "type": "literal",
                                                        "value": "Module experiencing issues: %s"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": "module"
                                                      }
                                                    ]
                                                  },
                                                  "message": {
                                                    "type": "call",
                                                    "fun": "sprintf",
                                                    "args": [
                                                      {
                                                        "type": "literal",
                                                        "value": "Module '%s' has reported %d errors in the last %d minutes"
                                                      },
                                                      {
                                                        "type": "name",
                                                        "value": "module"
                                                      },
                                                      {
                                                        "type": "call",
                                                        "fun": "[",
                                                        "args": [
                                                          {
                                                            "type": "name",
                                                            "value": "module_counts"
                                                          },
                                                          {
                                                            "type": "name",
                                                            "value": "module"
                                                          }
                                                        ]
                                                      },
                                                      {
                                                        "type": "call",
                                                        "fun": "$",
                                                        "args": [
                                                          {
                                                            "type": "name",
                                                            "value": ".error_monitor_config"
                                                          },
                                                          {
                                                            "type": "name",
                                                            "value": "alert_window_minutes"
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  }
                                                }
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "send_alert"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": ["", "", "", "NULL"]
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "alert_record"
                  },
                  {
                    "type": "call",
                    "fun": "list",
                    "args": {
                      "timestamp": {
                        "type": "call",
                        "fun": "Sys.time",
                        "args": []
                      },
                      "level": {
                        "type": "name",
                        "value": "level"
                      },
                      "subject": {
                        "type": "name",
                        "value": "subject"
                      },
                      "message": {
                        "type": "name",
                        "value": "message"
                      },
                      "error_id": {
                        "type": "name",
                        "value": "error_id"
                      }
                    }
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "alert_key"
                  },
                  {
                    "type": "call",
                    "fun": "paste0",
                    "args": [
                      {
                        "type": "name",
                        "value": "level"
                      },
                      {
                        "type": "literal",
                        "value": "_"
                      },
                      {
                        "type": "call",
                        "fun": "gsub",
                        "args": [
                          {
                            "type": "literal",
                            "value": "[^a-zA-Z0-9]"
                          },
                          {
                            "type": "literal",
                            "value": "_"
                          },
                          {
                            "type": "name",
                            "value": "subject"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "[[",
                    "args": [
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": ".error_store"
                          },
                          {
                            "type": "name",
                            "value": "alerts_sent"
                          }
                        ]
                      },
                      {
                        "type": "name",
                        "value": "alert_key"
                      }
                    ]
                  },
                  {
                    "type": "name",
                    "value": "alert_record"
                  }
                ]
              },
              {
                "type": "call",
                "fun": "cat",
                "args": [
                  {
                    "type": "call",
                    "fun": "sprintf",
                    "args": [
                      {
                        "type": "literal",
                        "value": "\n[%s ALERT] %s\n%s\n\n"
                      },
                      {
                        "type": "name",
                        "value": "level"
                      },
                      {
                        "type": "name",
                        "value": "subject"
                      },
                      {
                        "type": "name",
                        "value": "message"
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": ".error_monitor_config"
                      },
                      {
                        "type": "name",
                        "value": "email_alerts"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "send_email_alert",
                        "args": [
                          {
                            "type": "name",
                            "value": "alert_record"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "!",
                    "args": [
                      {
                        "type": "call",
                        "fun": "is.null",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": ".error_monitor_config"
                              },
                              {
                                "type": "name",
                                "value": "slack_webhook"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "send_slack_alert",
                        "args": [
                          {
                            "type": "name",
                            "value": "alert_record"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "log_alert",
                "args": [
                  {
                    "type": "name",
                    "value": "alert_record"
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "has_recent_alert"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": ""
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "alert"
                  },
                  {
                    "type": "call",
                    "fun": "[[",
                    "args": [
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": ".error_store"
                          },
                          {
                            "type": "name",
                            "value": "alerts_sent"
                          }
                        ]
                      },
                      {
                        "type": "name",
                        "value": "alert_key"
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "is.null",
                    "args": [
                      {
                        "type": "name",
                        "value": "alert"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "return",
                    "args": [
                      {
                        "type": "literal",
                        "value": false
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": ">",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": "alert"
                      },
                      {
                        "type": "name",
                        "value": "timestamp"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "(",
                    "args": [
                      {
                        "type": "call",
                        "fun": "-",
                        "args": [
                          {
                            "type": "call",
                            "fun": "Sys.time",
                            "args": []
                          },
                          {
                            "type": "call",
                            "fun": ["::", "lubridate", "minutes"],
                            "args": [
                              {
                                "type": "literal",
                                "value": 30
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "schedule_cleanup"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "NULL",
            "value": []
          },
          {
            "type": "call",
            "fun": "{",
            "args": []
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "cleanup_old_errors"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "NULL",
            "value": []
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "cutoff"
                  },
                  {
                    "type": "call",
                    "fun": "-",
                    "args": [
                      {
                        "type": "call",
                        "fun": "Sys.time",
                        "args": []
                      },
                      {
                        "type": "call",
                        "fun": ["::", "lubridate", "hours"],
                        "args": [
                          {
                            "type": "literal",
                            "value": 24
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": ".error_store"
                      },
                      {
                        "type": "name",
                        "value": "errors"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "Filter",
                    "args": [
                      {
                        "type": "call",
                        "fun": "function",
                        "args": [
                          {
                            "type": "pairlist",
                            "value": ""
                          },
                          {
                            "type": "call",
                            "fun": ">=",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "e"
                                  },
                                  {
                                    "type": "name",
                                    "value": "timestamp"
                                  }
                                ]
                              },
                              {
                                "type": "name",
                                "value": "cutoff"
                              }
                            ]
                          },
                          {
                            "type": "NULL",
                            "value": []
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": ".error_store"
                          },
                          {
                            "type": "name",
                            "value": "errors"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "alert_cutoff"
                  },
                  {
                    "type": "call",
                    "fun": "-",
                    "args": [
                      {
                        "type": "call",
                        "fun": "Sys.time",
                        "args": []
                      },
                      {
                        "type": "call",
                        "fun": ["::", "lubridate", "hours"],
                        "args": [
                          {
                            "type": "literal",
                            "value": 6
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": ".error_store"
                      },
                      {
                        "type": "name",
                        "value": "alerts_sent"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "Filter",
                    "args": [
                      {
                        "type": "call",
                        "fun": "function",
                        "args": [
                          {
                            "type": "pairlist",
                            "value": ""
                          },
                          {
                            "type": "call",
                            "fun": ">=",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "a"
                                  },
                                  {
                                    "type": "name",
                                    "value": "timestamp"
                                  }
                                ]
                              },
                              {
                                "type": "name",
                                "value": "alert_cutoff"
                              }
                            ]
                          },
                          {
                            "type": "NULL",
                            "value": []
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": ".error_store"
                          },
                          {
                            "type": "name",
                            "value": "alerts_sent"
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "get_error_stats"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": "24"
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "since"
                  },
                  {
                    "type": "call",
                    "fun": "-",
                    "args": [
                      {
                        "type": "call",
                        "fun": "Sys.time",
                        "args": []
                      },
                      {
                        "type": "call",
                        "fun": ["::", "lubridate", "hours"],
                        "args": [
                          {
                            "type": "name",
                            "value": "hours"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "recent_errors"
                  },
                  {
                    "type": "call",
                    "fun": "Filter",
                    "args": [
                      {
                        "type": "call",
                        "fun": "function",
                        "args": [
                          {
                            "type": "pairlist",
                            "value": ""
                          },
                          {
                            "type": "call",
                            "fun": ">=",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "e"
                                  },
                                  {
                                    "type": "name",
                                    "value": "timestamp"
                                  }
                                ]
                              },
                              {
                                "type": "name",
                                "value": "since"
                              }
                            ]
                          },
                          {
                            "type": "NULL",
                            "value": []
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": ".error_store"
                          },
                          {
                            "type": "name",
                            "value": "errors"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "==",
                    "args": [
                      {
                        "type": "call",
                        "fun": "length",
                        "args": [
                          {
                            "type": "name",
                            "value": "recent_errors"
                          }
                        ]
                      },
                      {
                        "type": "literal",
                        "value": 0
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "return",
                        "args": [
                          {
                            "type": "call",
                            "fun": "list",
                            "args": {
                              "total": {
                                "type": "literal",
                                "value": 0
                              },
                              "by_severity": {
                                "type": "call",
                                "fun": "list",
                                "args": []
                              },
                              "by_module": {
                                "type": "call",
                                "fun": "list",
                                "args": []
                              },
                              "by_type": {
                                "type": "call",
                                "fun": "list",
                                "args": []
                              },
                              "rate_per_hour": {
                                "type": "literal",
                                "value": 0
                              },
                              "recent_errors": {
                                "type": "call",
                                "fun": "list",
                                "args": []
                              }
                            }
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "severities"
                  },
                  {
                    "type": "call",
                    "fun": "sapply",
                    "args": [
                      {
                        "type": "name",
                        "value": "recent_errors"
                      },
                      {
                        "type": "call",
                        "fun": "function",
                        "args": [
                          {
                            "type": "pairlist",
                            "value": ""
                          },
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "e"
                              },
                              {
                                "type": "name",
                                "value": "severity"
                              }
                            ]
                          },
                          {
                            "type": "NULL",
                            "value": []
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "modules"
                  },
                  {
                    "type": "call",
                    "fun": "sapply",
                    "args": [
                      {
                        "type": "name",
                        "value": "recent_errors"
                      },
                      {
                        "type": "call",
                        "fun": "function",
                        "args": [
                          {
                            "type": "pairlist",
                            "value": ""
                          },
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "e"
                              },
                              {
                                "type": "name",
                                "value": "module"
                              }
                            ]
                          },
                          {
                            "type": "NULL",
                            "value": []
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "types"
                  },
                  {
                    "type": "call",
                    "fun": "sapply",
                    "args": [
                      {
                        "type": "name",
                        "value": "recent_errors"
                      },
                      {
                        "type": "call",
                        "fun": "function",
                        "args": [
                          {
                            "type": "pairlist",
                            "value": ""
                          },
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "e"
                              },
                              {
                                "type": "name",
                                "value": "error_type"
                              }
                            ]
                          },
                          {
                            "type": "NULL",
                            "value": []
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "list",
                "args": {
                  "total": {
                    "type": "call",
                    "fun": "length",
                    "args": [
                      {
                        "type": "name",
                        "value": "recent_errors"
                      }
                    ]
                  },
                  "by_severity": {
                    "type": "call",
                    "fun": "table",
                    "args": [
                      {
                        "type": "name",
                        "value": "severities"
                      }
                    ]
                  },
                  "by_module": {
                    "type": "call",
                    "fun": "table",
                    "args": [
                      {
                        "type": "call",
                        "fun": "[",
                        "args": [
                          {
                            "type": "name",
                            "value": "modules"
                          },
                          {
                            "type": "call",
                            "fun": "!",
                            "args": [
                              {
                                "type": "call",
                                "fun": "is.na",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "modules"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  "by_type": {
                    "type": "call",
                    "fun": "table",
                    "args": [
                      {
                        "type": "name",
                        "value": "types"
                      }
                    ]
                  },
                  "rate_per_hour": {
                    "type": "call",
                    "fun": "/",
                    "args": [
                      {
                        "type": "call",
                        "fun": "length",
                        "args": [
                          {
                            "type": "name",
                            "value": "recent_errors"
                          }
                        ]
                      },
                      {
                        "type": "name",
                        "value": "hours"
                      }
                    ]
                  },
                  "recent_errors": {
                    "type": "call",
                    "fun": "tail",
                    "args": [
                      {
                        "type": "name",
                        "value": "recent_errors"
                      },
                      {
                        "type": "literal",
                        "value": 10
                      }
                    ]
                  }
                }
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "get_error_trends"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": ["24", "hour"]
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "since"
                  },
                  {
                    "type": "call",
                    "fun": "-",
                    "args": [
                      {
                        "type": "call",
                        "fun": "Sys.time",
                        "args": []
                      },
                      {
                        "type": "call",
                        "fun": ["::", "lubridate", "hours"],
                        "args": [
                          {
                            "type": "name",
                            "value": "hours"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "recent_errors"
                  },
                  {
                    "type": "call",
                    "fun": "Filter",
                    "args": [
                      {
                        "type": "call",
                        "fun": "function",
                        "args": [
                          {
                            "type": "pairlist",
                            "value": ""
                          },
                          {
                            "type": "call",
                            "fun": ">=",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "e"
                                  },
                                  {
                                    "type": "name",
                                    "value": "timestamp"
                                  }
                                ]
                              },
                              {
                                "type": "name",
                                "value": "since"
                              }
                            ]
                          },
                          {
                            "type": "NULL",
                            "value": []
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": ".error_store"
                          },
                          {
                            "type": "name",
                            "value": "errors"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "==",
                    "args": [
                      {
                        "type": "call",
                        "fun": "length",
                        "args": [
                          {
                            "type": "name",
                            "value": "recent_errors"
                          }
                        ]
                      },
                      {
                        "type": "literal",
                        "value": 0
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "return",
                        "args": [
                          {
                            "type": "call",
                            "fun": "data.frame",
                            "args": {
                              "time": {
                                "type": "call",
                                "fun": "character",
                                "args": []
                              },
                              "count": {
                                "type": "call",
                                "fun": "integer",
                                "args": []
                              },
                              "severity": {
                                "type": "call",
                                "fun": "character",
                                "args": []
                              }
                            }
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "timestamps"
                  },
                  {
                    "type": "call",
                    "fun": "sapply",
                    "args": [
                      {
                        "type": "name",
                        "value": "recent_errors"
                      },
                      {
                        "type": "call",
                        "fun": "function",
                        "args": [
                          {
                            "type": "pairlist",
                            "value": ""
                          },
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "e"
                              },
                              {
                                "type": "name",
                                "value": "timestamp"
                              }
                            ]
                          },
                          {
                            "type": "NULL",
                            "value": []
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "severities"
                  },
                  {
                    "type": "call",
                    "fun": "sapply",
                    "args": [
                      {
                        "type": "name",
                        "value": "recent_errors"
                      },
                      {
                        "type": "call",
                        "fun": "function",
                        "args": [
                          {
                            "type": "pairlist",
                            "value": ""
                          },
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "e"
                              },
                              {
                                "type": "name",
                                "value": "severity"
                              }
                            ]
                          },
                          {
                            "type": "NULL",
                            "value": []
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "binned_times"
                  },
                  {
                    "type": "call",
                    "fun": ["::", "lubridate", "floor_date"],
                    "args": [
                      {
                        "type": "call",
                        "fun": "as.POSIXct",
                        "args": {
                          "1": {
                            "type": "name",
                            "value": "timestamps"
                          },
                          "origin": {
                            "type": "literal",
                            "value": "1970-01-01"
                          }
                        }
                      },
                      {
                        "type": "name",
                        "value": "interval"
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "trend_data"
                  },
                  {
                    "type": "call",
                    "fun": "aggregate",
                    "args": [
                      {
                        "type": "call",
                        "fun": "list",
                        "args": {
                          "count": {
                            "type": "call",
                            "fun": "rep",
                            "args": [
                              {
                                "type": "literal",
                                "value": 1
                              },
                              {
                                "type": "call",
                                "fun": "length",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "binned_times"
                                  }
                                ]
                              }
                            ]
                          }
                        }
                      },
                      {
                        "type": "call",
                        "fun": "list",
                        "args": {
                          "time": {
                            "type": "name",
                            "value": "binned_times"
                          },
                          "severity": {
                            "type": "name",
                            "value": "severities"
                          }
                        }
                      },
                      {
                        "type": "name",
                        "value": "sum"
                      }
                    ]
                  }
                ]
              },
              {
                "type": "name",
                "value": "trend_data"
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "generate_error_id"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "NULL",
            "value": []
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "paste0",
                "args": [
                  {
                    "type": "literal",
                    "value": "ERR_"
                  },
                  {
                    "type": "call",
                    "fun": "format",
                    "args": [
                      {
                        "type": "call",
                        "fun": "Sys.time",
                        "args": []
                      },
                      {
                        "type": "literal",
                        "value": "%Y%m%d%H%M%S"
                      }
                    ]
                  },
                  {
                    "type": "literal",
                    "value": "_"
                  },
                  {
                    "type": "call",
                    "fun": "substr",
                    "args": [
                      {
                        "type": "call",
                        "fun": ["::", "digest", "digest"],
                        "args": [
                          {
                            "type": "call",
                            "fun": "runif",
                            "args": [
                              {
                                "type": "literal",
                                "value": 1
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "literal",
                        "value": 1
                      },
                      {
                        "type": "literal",
                        "value": 8
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "capture_stack_trace"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "NULL",
            "value": []
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "calls"
                  },
                  {
                    "type": "call",
                    "fun": "sys.calls",
                    "args": []
                  }
                ]
              },
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": ">",
                    "args": [
                      {
                        "type": "call",
                        "fun": "length",
                        "args": [
                          {
                            "type": "name",
                            "value": "calls"
                          }
                        ]
                      },
                      {
                        "type": "literal",
                        "value": 2
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "<-",
                        "args": [
                          {
                            "type": "name",
                            "value": "calls"
                          },
                          {
                            "type": "call",
                            "fun": "[",
                            "args": [
                              {
                                "type": "name",
                                "value": "calls"
                              },
                              {
                                "type": "call",
                                "fun": ":",
                                "args": [
                                  {
                                    "type": "literal",
                                    "value": 1
                                  },
                                  {
                                    "type": "call",
                                    "fun": "(",
                                    "args": [
                                      {
                                        "type": "call",
                                        "fun": "-",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "length",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "calls"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "literal",
                                            "value": 2
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "lapply",
                "args": [
                  {
                    "type": "name",
                    "value": "calls"
                  },
                  {
                    "type": "name",
                    "value": "deparse"
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "get_session_id"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "NULL",
            "value": []
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "&&",
                    "args": [
                      {
                        "type": "call",
                        "fun": "exists",
                        "args": [
                          {
                            "type": "literal",
                            "value": "session"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "!",
                        "args": [
                          {
                            "type": "call",
                            "fun": "is.null",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "session"
                                  },
                                  {
                                    "type": "name",
                                    "value": "token"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "return",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "session"
                              },
                              {
                                "type": "name",
                                "value": "token"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "return",
                "args": [
                  {
                    "type": "literal",
                    "value": null
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "get_current_user"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "NULL",
            "value": []
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "if",
                "args": [
                  {
                    "type": "call",
                    "fun": "&&",
                    "args": [
                      {
                        "type": "call",
                        "fun": "exists",
                        "args": [
                          {
                            "type": "literal",
                            "value": "session"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "!",
                        "args": [
                          {
                            "type": "call",
                            "fun": "is.null",
                            "args": [
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "session"
                                  },
                                  {
                                    "type": "name",
                                    "value": "user"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "{",
                    "args": [
                      {
                        "type": "call",
                        "fun": "return",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "session"
                              },
                              {
                                "type": "name",
                                "value": "user"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "return",
                "args": [
                  {
                    "type": "call",
                    "fun": "Sys.getenv",
                    "args": [
                      {
                        "type": "literal",
                        "value": "USER"
                      },
                      {
                        "type": "literal",
                        "value": "unknown"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "write_error_log"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": ""
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "log_dir"
                  },
                  {
                    "type": "literal",
                    "value": "log/errors"
                  }
                ]
              },
              {
                "type": "call",
                "fun": "dir.create",
                "args": {
                  "1": {
                    "type": "name",
                    "value": "log_dir"
                  },
                  "showWarnings": {
                    "type": "literal",
                    "value": false
                  },
                  "recursive": {
                    "type": "literal",
                    "value": true
                  }
                }
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "log_file"
                  },
                  {
                    "type": "call",
                    "fun": "file.path",
                    "args": [
                      {
                        "type": "name",
                        "value": "log_dir"
                      },
                      {
                        "type": "call",
                        "fun": "sprintf",
                        "args": [
                          {
                            "type": "literal",
                            "value": "errors_%s.log"
                          },
                          {
                            "type": "call",
                            "fun": "format",
                            "args": [
                              {
                                "type": "call",
                                "fun": "Sys.Date",
                                "args": []
                              },
                              {
                                "type": "literal",
                                "value": "%Y%m%d"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "log_entry"
                  },
                  {
                    "type": "call",
                    "fun": "sprintf",
                    "args": [
                      {
                        "type": "literal",
                        "value": "[%s] %s | %s | %s | %s | %s"
                      },
                      {
                        "type": "call",
                        "fun": "format",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "error_record"
                              },
                              {
                                "type": "name",
                                "value": "timestamp"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "%Y-%m-%d %H:%M:%S"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "error_record"
                          },
                          {
                            "type": "name",
                            "value": "severity"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "error_record"
                          },
                          {
                            "type": "name",
                            "value": "error_type"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "error_record"
                          },
                          {
                            "type": "name",
                            "value": "module"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "error_record"
                          },
                          {
                            "type": "name",
                            "value": "message"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "error_record"
                          },
                          {
                            "type": "name",
                            "value": "user"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "cat",
                "args": {
                  "1": {
                    "type": "name",
                    "value": "log_entry"
                  },
                  "2": {
                    "type": "literal",
                    "value": "\n"
                  },
                  "file": {
                    "type": "name",
                    "value": "log_file"
                  },
                  "append": {
                    "type": "literal",
                    "value": true
                  }
                }
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "format_alert_message"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": ""
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "sprintf",
                "args": [
                  {
                    "type": "literal",
                    "value": "Error Details:\n\nType: %s\nSeverity: %s\nModule: %s\nMessage: %s\nTime: %s\nUser: %s\nSession: %s\nEnvironment: %s\n\nContext: %s"
                  },
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": "error_record"
                      },
                      {
                        "type": "name",
                        "value": "error_type"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": "error_record"
                      },
                      {
                        "type": "name",
                        "value": "severity"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "%||%",
                    "args": [
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "error_record"
                          },
                          {
                            "type": "name",
                            "value": "module"
                          }
                        ]
                      },
                      {
                        "type": "literal",
                        "value": "Unknown"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": "error_record"
                      },
                      {
                        "type": "name",
                        "value": "message"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": "error_record"
                      },
                      {
                        "type": "name",
                        "value": "timestamp"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": "error_record"
                      },
                      {
                        "type": "name",
                        "value": "user"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "%||%",
                    "args": [
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "error_record"
                          },
                          {
                            "type": "name",
                            "value": "session_id"
                          }
                        ]
                      },
                      {
                        "type": "literal",
                        "value": "N/A"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": "error_record"
                      },
                      {
                        "type": "name",
                        "value": "environment"
                      }
                    ]
                  },
                  {
                    "type": "call",
                    "fun": ["::", "jsonlite", "toJSON"],
                    "args": {
                      "1": {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "error_record"
                          },
                          {
                            "type": "name",
                            "value": "context"
                          }
                        ]
                      },
                      "pretty": {
                        "type": "literal",
                        "value": true
                      },
                      "auto_unbox": {
                        "type": "literal",
                        "value": true
                      }
                    }
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "format_rate_alert"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": ""
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "summary"
                  },
                  {
                    "type": "call",
                    "fun": "table",
                    "args": [
                      {
                        "type": "call",
                        "fun": "sapply",
                        "args": [
                          {
                            "type": "name",
                            "value": "errors"
                          },
                          {
                            "type": "call",
                            "fun": "function",
                            "args": [
                              {
                                "type": "pairlist",
                                "value": ""
                              },
                              {
                                "type": "call",
                                "fun": "$",
                                "args": [
                                  {
                                    "type": "name",
                                    "value": "e"
                                  },
                                  {
                                    "type": "name",
                                    "value": "error_type"
                                  }
                                ]
                              },
                              {
                                "type": "NULL",
                                "value": []
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "paste0",
                "args": [
                  {
                    "type": "literal",
                    "value": "Error Summary:\n\n"
                  },
                  {
                    "type": "literal",
                    "value": "Total errors: "
                  },
                  {
                    "type": "call",
                    "fun": "length",
                    "args": [
                      {
                        "type": "name",
                        "value": "errors"
                      }
                    ]
                  },
                  {
                    "type": "literal",
                    "value": "\n"
                  },
                  {
                    "type": "literal",
                    "value": "Time window: Last "
                  },
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": ".error_monitor_config"
                      },
                      {
                        "type": "name",
                        "value": "alert_window_minutes"
                      }
                    ]
                  },
                  {
                    "type": "literal",
                    "value": " minutes\n\n"
                  },
                  {
                    "type": "literal",
                    "value": "Error types:\n"
                  },
                  {
                    "type": "call",
                    "fun": "paste",
                    "args": {
                      "1": {
                        "type": "call",
                        "fun": "sprintf",
                        "args": [
                          {
                            "type": "literal",
                            "value": "  - %s: %d"
                          },
                          {
                            "type": "call",
                            "fun": "names",
                            "args": [
                              {
                                "type": "name",
                                "value": "summary"
                              }
                            ]
                          },
                          {
                            "type": "name",
                            "value": "summary"
                          }
                        ]
                      },
                      "collapse": {
                        "type": "literal",
                        "value": "\n"
                      }
                    }
                  },
                  {
                    "type": "literal",
                    "value": "\n\nMost recent errors:\n"
                  },
                  {
                    "type": "call",
                    "fun": "paste",
                    "args": {
                      "1": {
                        "type": "call",
                        "fun": "sapply",
                        "args": [
                          {
                            "type": "call",
                            "fun": "tail",
                            "args": [
                              {
                                "type": "name",
                                "value": "errors"
                              },
                              {
                                "type": "literal",
                                "value": 5
                              }
                            ]
                          },
                          {
                            "type": "call",
                            "fun": "function",
                            "args": [
                              {
                                "type": "pairlist",
                                "value": ""
                              },
                              {
                                "type": "call",
                                "fun": "{",
                                "args": [
                                  {
                                    "type": "call",
                                    "fun": "sprintf",
                                    "args": [
                                      {
                                        "type": "literal",
                                        "value": "  [%s] %s: %s"
                                      },
                                      {
                                        "type": "call",
                                        "fun": "format",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "e"
                                              },
                                              {
                                                "type": "name",
                                                "value": "timestamp"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "literal",
                                            "value": "%H:%M:%S"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "$",
                                        "args": [
                                          {
                                            "type": "name",
                                            "value": "e"
                                          },
                                          {
                                            "type": "name",
                                            "value": "error_type"
                                          }
                                        ]
                                      },
                                      {
                                        "type": "call",
                                        "fun": "substr",
                                        "args": [
                                          {
                                            "type": "call",
                                            "fun": "$",
                                            "args": [
                                              {
                                                "type": "name",
                                                "value": "e"
                                              },
                                              {
                                                "type": "name",
                                                "value": "message"
                                              }
                                            ]
                                          },
                                          {
                                            "type": "literal",
                                            "value": 1
                                          },
                                          {
                                            "type": "literal",
                                            "value": 50
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "type": "NULL",
                                "value": []
                              }
                            ]
                          }
                        ]
                      },
                      "collapse": {
                        "type": "literal",
                        "value": "\n"
                      }
                    }
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "send_email_alert"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": ""
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "message",
                "args": [
                  {
                    "type": "literal",
                    "value": "Email alert would be sent: "
                  },
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": "alert_record"
                      },
                      {
                        "type": "name",
                        "value": "subject"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "send_slack_alert"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": ""
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "message",
                "args": [
                  {
                    "type": "literal",
                    "value": "Slack alert would be sent: "
                  },
                  {
                    "type": "call",
                    "fun": "$",
                    "args": [
                      {
                        "type": "name",
                        "value": "alert_record"
                      },
                      {
                        "type": "name",
                        "value": "subject"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  },
  {
    "type": "call",
    "fun": "<-",
    "args": [
      {
        "type": "name",
        "value": "log_alert"
      },
      {
        "type": "call",
        "fun": "function",
        "args": [
          {
            "type": "pairlist",
            "value": ""
          },
          {
            "type": "call",
            "fun": "{",
            "args": [
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "log_dir"
                  },
                  {
                    "type": "literal",
                    "value": "log/alerts"
                  }
                ]
              },
              {
                "type": "call",
                "fun": "dir.create",
                "args": {
                  "1": {
                    "type": "name",
                    "value": "log_dir"
                  },
                  "showWarnings": {
                    "type": "literal",
                    "value": false
                  },
                  "recursive": {
                    "type": "literal",
                    "value": true
                  }
                }
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "log_file"
                  },
                  {
                    "type": "call",
                    "fun": "file.path",
                    "args": [
                      {
                        "type": "name",
                        "value": "log_dir"
                      },
                      {
                        "type": "call",
                        "fun": "sprintf",
                        "args": [
                          {
                            "type": "literal",
                            "value": "alerts_%s.log"
                          },
                          {
                            "type": "call",
                            "fun": "format",
                            "args": [
                              {
                                "type": "call",
                                "fun": "Sys.Date",
                                "args": []
                              },
                              {
                                "type": "literal",
                                "value": "%Y%m%d"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "<-",
                "args": [
                  {
                    "type": "name",
                    "value": "log_entry"
                  },
                  {
                    "type": "call",
                    "fun": "sprintf",
                    "args": [
                      {
                        "type": "literal",
                        "value": "[%s] %s | %s | %s"
                      },
                      {
                        "type": "call",
                        "fun": "format",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "alert_record"
                              },
                              {
                                "type": "name",
                                "value": "timestamp"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": "%Y-%m-%d %H:%M:%S"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "alert_record"
                          },
                          {
                            "type": "name",
                            "value": "level"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "$",
                        "args": [
                          {
                            "type": "name",
                            "value": "alert_record"
                          },
                          {
                            "type": "name",
                            "value": "subject"
                          }
                        ]
                      },
                      {
                        "type": "call",
                        "fun": "substr",
                        "args": [
                          {
                            "type": "call",
                            "fun": "$",
                            "args": [
                              {
                                "type": "name",
                                "value": "alert_record"
                              },
                              {
                                "type": "name",
                                "value": "message"
                              }
                            ]
                          },
                          {
                            "type": "literal",
                            "value": 1
                          },
                          {
                            "type": "literal",
                            "value": 100
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "type": "call",
                "fun": "cat",
                "args": {
                  "1": {
                    "type": "name",
                    "value": "log_entry"
                  },
                  "2": {
                    "type": "literal",
                    "value": "\n"
                  },
                  "file": {
                    "type": "name",
                    "value": "log_file"
                  },
                  "append": {
                    "type": "literal",
                    "value": true
                  }
                }
              }
            ]
          },
          {
            "type": "NULL",
            "value": []
          }
        ]
      }
    ]
  }
]
